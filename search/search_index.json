{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Statistical Genetics Notes","text":"<p>This site contains structured notes on population genetics and quantitative genetics, compiled during my PhD training.</p>"},{"location":"#contents","title":"Contents","text":"<ul> <li>Allele frequency theory and Hardy\u2013Weinberg equilibrium</li> <li>Genetic drift, selection, mutation, and migration</li> <li>Wright\u2013Fisher model</li> <li>Diffusion approximation</li> <li>Coalescent theory</li> <li>Statistical models in GWAS and population genomics</li> </ul>"},{"location":"#audience","title":"Audience","text":"<p>Graduate students and researchers in genetics, genomics, and evolutionary biology.</p>"},{"location":"#status","title":"Status","text":"<p>\ud83d\udea7 This is a living document and will be continuously updated.</p>"},{"location":"00_Meta/What_is_statistical_genetics_about/","title":"What is statistical genetics?","text":"<p>Statistical genetics studies how genetic variation explains phenotypic variation and evolutionary change.</p>"},{"location":"00_Meta/What_is_statistical_genetics_about/#two-complementary-perspectives","title":"Two complementary perspectives","text":"<ul> <li> <p>Frequency dynamics   Focus on how allele frequencies change in populations   under selection, drift, mutation, migration and recombination.</p> </li> <li> <p>Variance dynamics   Focus on how genetic variance structures phenotypic distributions   and determines response to selection.</p> </li> </ul>"},{"location":"00_Meta/What_is_statistical_genetics_about/#why-use-the-term-dynamics","title":"Why use the term \"dynamics\"?","text":"<p>This note explains why the concept of dynamics is used as a core organizing principle in this vault, especially for population genetics and quantitative genetics.</p>"},{"location":"00_Meta/What_is_statistical_genetics_about/#what-is-meant-by-dynamics","title":"What is meant by dynamics?","text":"<p>In the most general sense, dynamics refers to the study of how state variables evolve over time under well-defined rules.</p> <p>A system is dynamical if: 1. It has identifiable state variables. 2. These variables change across time or iterations. 3. There exist rules governing this change.</p>"},{"location":"00_Meta/What_is_statistical_genetics_about/#why-genetics-can-be-framed-dynamically","title":"Why genetics can be framed dynamically","text":"<p>In population genetics, the state variable is allele frequency \\(p\\), and time is measured in generations. Evolutionary forces such as selection, drift, mutation and migration define the update rule:</p> \\[ p_{t+1} = f(p_t) \\] <p>In quantitative genetics, the state variables are genetic variance components (e.g. \\(V_A\\)) and trait means. Their evolution across generations follows rules such as the breeder\u2019s equation.</p> <p>Thus, both fields naturally study temporal evolution of system states, which justifies the use of the term \"dynamics\".</p>"},{"location":"00_Meta/What_is_statistical_genetics_about/#key-unifying-question","title":"Key unifying question","text":"<p>How are allele-frequency changes translated into changes in genetic variance and phenotypic means?</p>"},{"location":"01_Core/Frequency%20dynamics/","title":"Frequency dynamics","text":"<p>Study of how allele frequencies change across generations due to evolutionary forces. Core components: - Allele_frequency (state variable) - Selection(general), Genetic drift, Mutation, Migration (drivers) - Wright_Fisher_model (population model) - Coalescent_theory (time perspective) - Site_frequency_spectrum (statistical consequence)</p> <p>See also What_is_statistical_genetics_about.</p>"},{"location":"01_Core/Frequency%20dynamics/#1-state-variable","title":"1. State variable","text":"<ul> <li>Allele frequency \\(p\\)</li> <li>Genotype frequencies (\\(p\u00b2, 2pq, q\u00b2\\))</li> <li>Multiallelic extension \u2192 Hardy_Weinberg_equilibrium \u2192 Allele_frequency</li> </ul>"},{"location":"01_Core/Frequency%20dynamics/#2-time","title":"2. Time","text":"<ul> <li>Discrete generations</li> <li>Continuous-time approximation</li> <li>Scaling with N\u2091</li> </ul>"},{"location":"01_Core/Frequency%20dynamics/#3-update-rules","title":"3. Update rules","text":"<p>General form: $$ p_{t+1} = f(p_t; \\theta) $$</p> <p>where \\(\u03b8\\) includes: - Selection coefficients - Mutation rates - Migration rates - Drift (stochasticity)</p>"},{"location":"01_Core/Frequency%20dynamics/#4-deterministic-vs-stochastic-dynamics","title":"4. Deterministic vs stochastic dynamics","text":"<ul> <li>Infinite population limit</li> <li>Finite population (sampling noise)</li> </ul>"},{"location":"01_Core/Variance%20dynamics/","title":"Variance dynamics","text":"<p>Study of how genetic variance components shape phenotypic variation and response to selection. See also What_is_statistical_genetics_about.</p>"},{"location":"01_Core/00_single_locus/Allele_frequency/","title":"Allele frequency","text":""},{"location":"01_Core/00_single_locus/Allele_frequency/#1-definition","title":"1. Definition","text":"<p>Consider a single locus with two alleles \\(A\\) and \\(a\\).</p> <ul> <li>\\(p = frequency\\ of\\ allele\\ A\\)</li> <li>\\(q = 1 \u2212 p\\)</li> </ul>"},{"location":"01_Core/00_single_locus/Allele_frequency/#2-relation-to-genotype-frequencies","title":"2. Relation to genotype frequencies","text":"<p>Under random mating: - \\(f(AA) = p\u00b2\\) - \\(f(Aa) = 2pq\\) - \\(f(aa) = q\u00b2\\)</p> <p>Thus: $$ p = f(AA) + \\frac{1}{2} f(Aa) $$</p>"},{"location":"01_Core/00_single_locus/Allele_frequency/#3-state-space","title":"3. State space","text":"<ul> <li>\\(p \\in [0, 1]\\)</li> <li>Boundary states: \\(p = 0\\), \\(p = 1\\) (fixation)</li> <li>Absorbing states under drift</li> </ul>"},{"location":"01_Core/00_single_locus/Allele_frequency/#4-why-allele-frequency-is-the-natural-state-variable","title":"4. Why allele frequency is the natural state variable","text":"<ul> <li>Evolutionary forces act on alleles</li> <li>Individual identities are irrelevant</li> <li>Sufficient statistic under random mating</li> </ul>"},{"location":"01_Core/00_single_locus/Allele_frequency/#5-what-information-is-lost","title":"5. What information is lost","text":"<ul> <li>Genotype phase</li> <li>Linkage</li> <li>Individual ancestry</li> </ul>"},{"location":"01_Core/00_single_locus/Allele_frequency/#links","title":"Links","text":"<ul> <li>Frequency dynamics</li> <li>Wright_Fisher_model</li> </ul>"},{"location":"01_Core/00_single_locus/Hardy_Weinberg_equilibrium/","title":"Hardy\u2013Weinberg equilibrium","text":""},{"location":"01_Core/00_single_locus/Hardy_Weinberg_equilibrium/#1-statement-of-the-hardyweinberg-law","title":"1. Statement of the Hardy\u2013Weinberg law","text":"<p>Hardy\u2013Weinberg equilibrium (HWE) states that:</p> <p>In a randomly mating population with no evolutionary forces, genotype frequencies are completely determined by allele frequencies and remain constant across generations.</p> <p>Formally, for a biallelic locus with allele frequencies: $$ p = \\text{freq}(A), \\quad q = 1 - p $$</p> <p>the genotype frequencies are: $$ AA : p^2,\\quad Aa : 2pq,\\quad aa : q^2 $$</p>"},{"location":"01_Core/00_single_locus/Hardy_Weinberg_equilibrium/#2-what-hardyweinberg-is-really-about","title":"2. What Hardy\u2013Weinberg is really about","text":"<p>Hardy\u2013Weinberg is not primarily a formula. It is a reference state.</p> <p>In the language of dynamics:</p> <p>Hardy\u2013Weinberg equilibrium is the fixed point of the genetic system when all evolutionary forces are absent.</p> <p>It defines:</p> <ul> <li>the null model of population genetics</li> <li>the baseline state against which all deviations are interpreted</li> </ul>"},{"location":"01_Core/00_single_locus/Hardy_Weinberg_equilibrium/#3-assumptions-as-modeling-constraints","title":"3. Assumptions (as modeling constraints)","text":"<p>Hardy\u2013Weinberg equilibrium holds under the following assumptions:</p> <ul> <li>random mating</li> <li>infinite population size</li> <li>no selection</li> <li>no mutation</li> <li>no migration</li> <li>no genetic drift</li> <li>no population structure</li> <li>no inbreeding</li> </ul> <p>These assumptions are not meant to be realistic, but diagnostic.</p>"},{"location":"01_Core/00_single_locus/Hardy_Weinberg_equilibrium/#each-violation-of-an-assumption-corresponds-to-a-specific-evolutionary-process","title":"&gt; Each violation of an assumption corresponds to a specific evolutionary process.","text":""},{"location":"01_Core/00_single_locus/Hardy_Weinberg_equilibrium/#4-hardyweinberg-as-a-fixed-point","title":"4. Hardy\u2013Weinberg as a fixed point","text":"<p>From a dynamical perspective:</p> <ul> <li>Allele frequencies \\(p\\) are state variables</li> <li>Genotype frequencies are functions of \\(p\\)</li> </ul> <p>If no evolutionary forces act: $$ \\frac{dp}{dt} = 0 $$</p> <p>and the system remains at:</p> \\[ (p^2,\\,2pq,\\,q^2)   \\] <p>Thus, Hardy\u2013Weinberg represents a neutral equilibrium state of the system.</p>"},{"location":"01_Core/00_single_locus/Hardy_Weinberg_equilibrium/#5-separation-of-timescales","title":"5. Separation of timescales","text":"<p>A key theoretical insight is that:</p> <p>Genotype frequencies relax to Hardy\u2013Weinberg equilibrium faster than allele frequencies change.</p> <p>This allows population genetics to operate on two levels:</p> <ol> <li>Fast dynamics</li> <li>random mating</li> <li> <p>restoration of HWE each generation</p> </li> <li> <p>Slow dynamics</p> </li> <li>mutation</li> <li>selection</li> <li>migration</li> <li>drift</li> </ol> <p>This separation justifies: - working primarily with allele frequencies - treating genotype frequencies as quasi-equilibrated</p>"},{"location":"01_Core/00_single_locus/Hardy_Weinberg_equilibrium/#6-hardyweinberg-as-a-null-model","title":"6. Hardy\u2013Weinberg as a null model","text":"<p>Hardy\u2013Weinberg equilibrium functions as the null hypothesis in population genetics.</p> <p>Observed deviation from HWE implies the presence of at least one process: - selection - inbreeding - population structure - assortative mating - genetic drift - genotyping error (in applied contexts) However:</p> <p>Deviation from HWE is not inherently a problem \u2014 it is information.</p>"},{"location":"01_Core/00_single_locus/Hardy_Weinberg_equilibrium/#7-what-hardyweinberg-does-not-assume","title":"7. What Hardy\u2013Weinberg does NOT assume","text":"<p>Clarifications to avoid common misconceptions:</p> <ul> <li>HWE does not assume equal fitness</li> <li>HWE does not imply absence of evolution forever</li> <li>HWE does not describe adaptive dynamics</li> </ul> <p>It simply describes the genetic composition of a population at a reference state.</p>"},{"location":"01_Core/00_single_locus/Hardy_Weinberg_equilibrium/#8-relationship-to-evolutionary-forces","title":"8. Relationship to evolutionary forces","text":"<p>Hardy\u2013Weinberg equilibrium is the baseline upon which evolutionary forces act:</p> Process Effect relative to HWE Mutation shifts allele frequencies Migration mixes allele pools Selection biases genotype survival Drift introduces stochastic deviation Inbreeding alters genotype proportions <p>All subsequent models can be written as: $$ \\text{HWE} + \\text{perturbation} $$</p>"},{"location":"01_Core/00_single_locus/Hardy_Weinberg_equilibrium/#9-role-in-population-genetics-theory","title":"9. Role in population genetics theory","text":"<p>Hardy\u2013Weinberg equilibrium provides:</p> <ul> <li>the starting point of frequency dynamics</li> <li>the reference frame for selection models</li> <li>the baseline for drift and diffusion theory</li> <li>the foundation for LD and haplotype theory</li> <li>the statistical null for GWAS quality control</li> </ul> <p>Without HWE, population genetics loses its coordinate system.</p>"},{"location":"01_Core/00_single_locus/Hardy_Weinberg_equilibrium/#10-conceptual-summary","title":"10. Conceptual summary","text":"<p>Hardy\u2013Weinberg equilibrium is not a law of nature, but a reference state of genetic systems in the absence of evolutionary forces. It defines the zero point of population genetics.</p>"},{"location":"01_Core/00_single_locus/Hardy_Weinberg_equilibrium/#links","title":"Links","text":"<ul> <li>Allele_frequency</li> <li>Frequency dynamics</li> <li>Variance dynamics</li> <li>Selection(general)</li> <li>Mutation</li> <li>Migration</li> <li>Genetic drift</li> <li>Linkage_disequilibrium</li> </ul>"},{"location":"01_Core/02_Structual_state/Population_structure/","title":"Population structure","text":"<p>Population structure describes the non-random distribution of allele frequencies across individuals due to subdivision of a population into partially isolated subpopulations.</p> <p>It is the most fundamental deviation from the idealized assumptions of: - Hardy\u2013Weinberg equilibrium - panmixia (random mating) - a single, well-mixed population</p> <p>Population structure is therefore a state of the population, not an evolutionary process itself.</p>"},{"location":"01_Core/02_Structual_state/Population_structure/#1-why-population-structure-matters","title":"1. Why population structure matters","text":"<p>Population structure matters because most statistical genetic models implicitly assume that all sampled individuals are drawn from a single, randomly mating population.</p> <p>When this assumption is violated: - allele frequencies vary across subpopulations, - genotype frequencies deviate from Hardy\u2013Weinberg expectations, - loci may appear correlated even without physical linkage, - spurious associations arise in GWAS.</p> <p>Thus, population structure is the primary source of confounding in population genetic inference.</p>"},{"location":"01_Core/02_Structual_state/Population_structure/#population-structure-transforms-individual-level-randomness-into-population-level-bias","title":"&gt; Population structure transforms individual-level randomness into population-level bias.","text":""},{"location":"01_Core/02_Structual_state/Population_structure/#2-formal-definition-allele-frequency-perspective","title":"2. Formal definition (allele frequency perspective)","text":"<p>Consider a biallelic locus with alleles \\(A\\) and \\(a\\).</p> <p>Let the population be subdivided into K subpopulations. In subpopulation k, the allele A has frequency \\(p_k\\).</p> <p>Population structure exists if: \\(p_1 \u2260 p_2 \u2260 ... \u2260 p_K\\)</p> <p>The fundamental object in population structure is not genotype, but the distribution of allele frequencies across subpopulations.</p>"},{"location":"01_Core/02_Structual_state/Population_structure/#3-sampling-from-a-structured-population","title":"3. Sampling from a structured population","text":"<p>Suppose a sample is drawn by pooling individuals from multiple subpopulations.</p> <p>Let: - \\(w_k\\) be the proportion of samples from subpopulation \\(k\\) - \\(p_k\\) be the allele frequency in subpopulation \\(k\\)</p> <p>The overall allele frequency in the pooled sample is: $$ p = \u03a3_k w_k p_k $$</p>"},{"location":"01_Core/02_Structual_state/Population_structure/#4-wahlund-effect-loss-of-heterozygosity","title":"4. Wahlund effect (loss of heterozygosity)","text":"<p>Even if each subpopulation is in Hardy\u2013Weinberg equilibrium, the pooled population generally is not.</p> <p>Expected heterozygosity within subpopulations: \\(H_within = \u03a3_k w_k 2 p_k (1 - p_k)\\)</p> <p>Expected heterozygosity under pooled allele frequency: \\(H_total = 2 p (1 - p)\\)</p> <p>In structured populations: \\(H_within &gt; H_total\\)</p> <p>Wahlund effect Population structure creates an apparent deficit of heterozygotes, not because of inbreeding or selection, but because alleles are sampled from different frequency backgrounds.</p>"},{"location":"01_Core/02_Structual_state/Population_structure/#5-population-structure-as-drift-in-parallel","title":"5. Population structure as drift in parallel","text":"<p>Population structure arises naturally through genetic drift acting independently in different subpopulations.</p> <p>Starting from the same ancestral population: - random drift causes allele frequencies to diverge, - different populations explore different evolutionary trajectories.</p> <p>Thus, population structure is the spatial imprint of genetic drift.</p> <p>Population structure is drift observed across space rather than time.</p>"},{"location":"01_Core/02_Structual_state/Population_structure/#6-differentiation-and-f-statistics-intuition-only","title":"6. Differentiation and F-statistics (intuition only)","text":"<p>Genetic differentiation between populations is commonly summarized by F-statistics.</p> <p>\\(F_ST\\) measures the fraction of total genetic variance that is explained by between-population differences in allele frequency.</p> <p>Conceptually: \\(F_ST = Var(p_k) / Var_total\\)</p> <p>At the core level, F_ST quantifies how much allele frequency variation</p>"},{"location":"01_Core/02_Structual_state/Population_structure/#7-migration-vs-population-structure","title":"7. Migration vs population structure","text":"<p>Population structure reflects a balance between two forces: - genetic drift, which differentiates populations, - migration, which homogenizes allele frequencies.</p> <p>Strong drift + weak migration \u2192 strong structure Weak drift + strong migration \u2192 weak structure</p>"},{"location":"01_Core/02_Structual_state/Population_structure/#migration-erodes-structure-drift-builds-it","title":"&gt; Migration erodes structure; drift builds it.","text":""},{"location":"01_Core/02_Structual_state/Population_structure/#8-relation-to-other-core-concepts","title":"8. Relation to other core concepts","text":"<p>Population structure directly affects:</p> <ul> <li>Hardy\u2013Weinberg equilibrium (via Wahlund effect)</li> <li>Linkage disequilibrium (via admixture LD)</li> <li>Allele frequency dynamics</li> <li>Variance dynamics</li> </ul> <p>Population structure provides the conceptual foundation for: - GWAS K matrix - Structured coalescent - Local ancestry and haplotypes</p>"},{"location":"01_Core/02_Structual_state/Population_structure/#9-what-this-chapter-does-not-cover","title":"9. What this chapter does NOT cover","text":"<p>This core chapter intentionally does not cover: - inference methods (PCA, ADMIXTURE, STRUCTURE), - structured coalescent theory, - likelihood-based models.</p> <p>These topics are treated in later Model-level notes.</p>"},{"location":"01_Core/02_Structual_state/Population_structure/#links","title":"Links","text":"<ul> <li>Hardy_Weinberg_equilibrium</li> <li>Genetic_drift</li> <li>Migration</li> <li>Linkage_disequilibrium</li> <li>GWAS_K_matrix</li> <li>Structured_coalescent</li> </ul>"},{"location":"02_Processes/Genetic%20drift/","title":"Genetic drift","text":""},{"location":"02_Processes/Genetic%20drift/#0-conceptual-position","title":"0. Conceptual position","text":"<p>Genetic drift marks the transition from deterministic population genetics to stochastic population genetics.</p> <p>Before drift:</p> <ul> <li>allele-frequency dynamics are deterministic</li> <li>evolution is described by forces (selection, mutation, migration)</li> </ul> <p>With drift:</p> <ul> <li>evolution becomes a random process</li> <li>population size (N) becomes essential</li> <li>fixation and loss become inevitable outcomes</li> </ul>"},{"location":"02_Processes/Genetic%20drift/#1-definition-rigorous-and-minimal","title":"1. Definition (rigorous and minimal)","text":"<p>Genetic drift is the stochastic fluctuation of allele frequencies caused by random sampling of gametes in finite populations.</p> <p>Key points:</p> <ul> <li>drift is not a force</li> <li>drift has no direction</li> <li>drift arises solely from finite population size</li> </ul>"},{"location":"02_Processes/Genetic%20drift/#2-why-drift-exists-probability-vs-frequency","title":"2. Why drift exists: probability vs frequency","text":"<p>In infinite populations: - allele frequency = probability</p> <p>In finite populations: - allele frequency = outcome of random sampling</p> <p>Thus:</p> <p>Even if the expected frequency is unchanged, the realized frequency fluctuates.</p> <p>This sampling noise is genetic drift.</p>"},{"location":"02_Processes/Genetic%20drift/#3-the-wrightfisher-model-axiomatic-foundation","title":"3. The Wright\u2013Fisher model (axiomatic foundation)","text":""},{"location":"02_Processes/Genetic%20drift/#31-model-assumptions","title":"3.1 Model assumptions","text":"<ul> <li>diploid population of constant size (\\(N\\))</li> <li>non-overlapping generations</li> <li>random mating</li> <li>no selection, mutation, or migration</li> <li>all gametes sampled independently</li> </ul> <p>This is the pure drift model.</p>"},{"location":"02_Processes/Genetic%20drift/#32-random-sampling-rule","title":"3.2 Random sampling rule","text":"<p>Let:</p> <ul> <li>(\\(p_t\\)) = frequency of allele (\\(A\\)) at generation (\\(t\\))</li> <li>(\\(X_{t+1}\\)) = number of (\\(A\\)) alleles in generation (\\(t+1\\))</li> </ul> <p>Then: $$ \\boxed{ X_{t+1} \\sim \\text{Binomial}(2N, p_t) } $$</p> <p>and</p> \\[   p_{t+1} = \\frac{X_{t+1}}{2N}   \\] <p>This is not an approximation \u2014 it is the definition of drift.</p>"},{"location":"02_Processes/Genetic%20drift/#4-expectation-and-variance-core-properties","title":"4. Expectation and variance (core properties)","text":""},{"location":"02_Processes/Genetic%20drift/#41-mean-behavior-no-directional-change","title":"4.1 Mean behavior (no directional change)","text":"\\[ \\mathbb{E}[p_{t+1} \\mid p_t] = p_t   \\] <p>Interpretation:</p> <ul> <li>drift is neutral</li> <li>no allele is systematically favored</li> </ul>"},{"location":"02_Processes/Genetic%20drift/#42-variance-strength-of-drift","title":"4.2 Variance (strength of drift)","text":"\\[ \\mathrm{Var}(p_{t+1} \\mid p_t) = \\frac{p_t(1-p_t)}{2N}   \\] <p>Implications:</p> <ul> <li>drift strength (\\(\\propto 1/N\\))</li> <li>strongest at intermediate frequencies</li> <li>zero at fixation boundaries</li> </ul> <p>This variance term is the engine of all stochastic effects.</p>"},{"location":"02_Processes/Genetic%20drift/#5-drift-as-a-random-walk-in-allele-frequency-space","title":"5. Drift as a random walk in allele-frequency space","text":"<p>Under drift:</p> <ul> <li>allele frequencies perform a random walk</li> <li>boundaries (\\(p=0\\)) and (\\(p=1\\)) are absorbing</li> </ul> <p>Unlike selection:</p> <ul> <li>there is no restoring force</li> <li>fluctuations accumulate over time</li> </ul>"},{"location":"02_Processes/Genetic%20drift/#6-absorbing-states-and-inevitability-of-fixation","title":"6. Absorbing states and inevitability of fixation","text":""},{"location":"02_Processes/Genetic%20drift/#61-absorbing-boundaries","title":"6.1 Absorbing boundaries","text":"<p>Once:</p> <ul> <li>(\\(p=0\\)) \u2192 allele lost forever</li> <li>(\\(p=1\\)) \u2192 allele fixed forever</li> </ul> <p>These states are absorbing, not merely stable.</p>"},{"location":"02_Processes/Genetic%20drift/#62-fixation-is-inevitable","title":"6.2 Fixation is inevitable","text":"<p>In the absence of mutation and migration:</p> \\[   \\boxed{   \\text{Fixation or loss occurs with probability } 1   }   \\] <p>This is a theorem, not a tendency.</p>"},{"location":"02_Processes/Genetic%20drift/#7-fixation-probability-fundamental-result","title":"7. Fixation probability (fundamental result)","text":"<p>For a neutral allele with initial frequency (\\(p_0\\)):</p> \\[ \\boxed{   \\mathbb{P}(\\text{fixation}) = p_0   }   \\] <p>Special cases:</p> <ul> <li>single new mutation: (\\(p_0 = \\frac{1}{2N}\\))</li> <li>fixation probability is extremely small in large populations</li> </ul> <p>Interpretation:</p> <p>Drift preserves expected frequencies, but destroys variation.</p>"},{"location":"02_Processes/Genetic%20drift/#8-time-to-fixation","title":"8. Time to fixation","text":"<p>Expected fixation time (neutral drift):</p> <ul> <li>scales with population size (\\(N\\))</li> <li>larger populations drift more slowly</li> <li>smaller populations drift rapidly</li> </ul> <p>Approximate results:</p> <ul> <li>time to fixation \\(\\sim \\mathcal O(N)\\) to \\(\\mathcal O(4N)\\) generations</li> </ul> <p>Thus:</p> <ul> <li>drift is weak but persistent</li> <li>long-term consequences are unavoidable</li> </ul>"},{"location":"02_Processes/Genetic%20drift/#9-drift-vs-selection-conceptual-contrast","title":"9. Drift vs selection (conceptual contrast)","text":"Aspect Selection Drift Nature deterministic force stochastic process Direction yes no Depends on fitness yes no Depends on (N) no yes Outcome optimization fixation by chance <p>Key insight:</p> <p>Selection determines which alleles tend to increase, drift determines whether they survive at all.</p>"},{"location":"02_Processes/Genetic%20drift/#10-drift-as-the-source-of-population-structure","title":"10. Drift as the source of population structure","text":"<p>Because drift acts independently in different populations:</p> <ul> <li>allele frequencies diverge</li> <li>genetic differentiation accumulates</li> <li>relatedness emerges</li> </ul> <p>This underlies:</p> <ul> <li>$F_{ST}</li> <li>kinship matrices (K in GWAS)</li> <li>PCA structure</li> <li>ancestry inference</li> </ul>"},{"location":"02_Processes/Genetic%20drift/#11-connection-to-diffusion-approximation-preview","title":"11. Connection to diffusion approximation (preview)","text":"<p>In the continuous limit:</p> \\[ dp = \\underbrace{M(p)\\,dt}_{\\text{forces}}   +   \\underbrace{\\sqrt{\\frac{p(1-p)}{2N}}\\,dW_t}_{\\text{drift}}   \\] <p>Where:</p> <ul> <li>\\(M(p)\\): selection + mutation + migration</li> <li>\\(dW_t\\): Wiener process</li> </ul> <p>This connects:</p> <ul> <li>Wright\u2013Fisher \u2192 diffusion \u2192 coalescent</li> </ul>"},{"location":"02_Processes/Genetic%20drift/#12-what-drift-explains-and-what-it-does-not","title":"12. What drift explains (and what it does not)","text":""},{"location":"02_Processes/Genetic%20drift/#explains","title":"Explains:","text":"<ul> <li>loss of variation</li> <li>random fixation</li> <li>population differentiation</li> <li>neutral evolution</li> <li>background for selection</li> </ul>"},{"location":"02_Processes/Genetic%20drift/#does-not-explain","title":"Does not explain:","text":"<ul> <li>adaptation</li> <li>fitness optimization</li> <li>directionality</li> </ul> <p>Drift is the default evolutionary background.</p> <p>Genetic drift is not an evolutionary force but the unavoidable stochastic consequence of finite population size, converting deterministic frequency dynamics into probabilistic evolutionary outcomes.</p> <p>Selection and genetic drift are orthogonal components of evolutionary dynamics: selection determines the deterministic direction of allele frequency change, while drift governs the stochastic variability around that direction.</p>"},{"location":"02_Processes/Genetic%20drift/#links","title":"Links","text":"<ul> <li>Hardy_Weinberg_equilibrium</li> <li>Allele_frequency</li> <li>Frequency dynamics</li> <li>Selection(general)</li> <li>Mutation</li> <li>Migration</li> <li>Diffusion_approximation</li> <li>Coalescent_theory</li> <li>Population_structure</li> <li>GWAS_K_matrix</li> </ul>"},{"location":"02_Processes/Migration/","title":"Migration","text":""},{"location":"02_Processes/Migration/#1-what-is-migration","title":"1. What is migration?","text":"<p>Migration is the deterministic change in allele frequency caused by the movement of individuals (or gametes) between populations.</p> <p>In population genetics, migration is modeled as a mixing process that alters allele frequencies by importing genetic material from other populations.</p> <p>Migration is a force acting on allele frequencies, not a stochastic process.</p>"},{"location":"02_Processes/Migration/#2-migration-as-a-deterministic-force","title":"2. Migration as a deterministic force","text":"<p>Unlike genetic drift:</p> <ul> <li>migration does not arise from randomness</li> <li>it has a direction and magnitude</li> <li>it does not require finite population size (\\(N\\))</li> </ul> <p>Mathematically, migration defines a deterministic mapping on allele-frequency space.</p> <p>This places migration in the same conceptual category as:</p> <ul> <li>mutation</li> <li>selection</li> </ul>"},{"location":"02_Processes/Migration/#3-the-simplest-model-one-population-receiving-migrants","title":"3. The simplest model: one population receiving migrants","text":""},{"location":"02_Processes/Migration/#assumptions","title":"Assumptions","text":"<ul> <li>Focal population with allele frequency (\\(p_t\\))</li> <li>Source population with allele frequency (\\(p_m\\))</li> <li>Migration rate (\\(m\\)): fraction of individuals replaced by migrants each generation</li> </ul>"},{"location":"02_Processes/Migration/#update-rule","title":"Update rule","text":"\\[ \\boxed{   p_{t+1} = (1-m)p_t + m p_m   }   \\] <p>Interpretation:</p> <ul> <li>fraction (\\(1-m\\)): local reproduction</li> <li>fraction (\\(m\\)): migrant contribution</li> </ul>"},{"location":"02_Processes/Migration/#4-continuous-time-limit","title":"4. Continuous-time limit","text":"<p>For small (m), we can write the continuous-time approximation:</p> \\[   \\boxed{   \\frac{dp}{dt} = m(p_m - p)   }   \\] <p>This is a linear differential equation describing migration as a restoring force.</p>"},{"location":"02_Processes/Migration/#5-fixed-point-and-stability","title":"5. Fixed point and stability","text":""},{"location":"02_Processes/Migration/#fixed-point","title":"Fixed point","text":"\\[   \\frac{dp}{dt} = 0   \\quad\\Rightarrow\\quad   p^* = p_m   \\] <p>The equilibrium allele frequency equals the source population frequency.</p>"},{"location":"02_Processes/Migration/#stability","title":"Stability","text":"<ul> <li>If (\\(p &gt; p_m\\)): migration decreases (\\(p\\))</li> <li>If (\\(p &lt; p_m\\)): migration increases (\\(p\\))</li> </ul> <p>Thus:</p> \\[   p^* = p_m \\quad \\text{is globally stable}   \\] <p>Migration always homogenizes allele frequencies.</p>"},{"location":"02_Processes/Migration/#6-migration-as-a-force-field","title":"6. Migration as a force field","text":"<p>In force-field language:</p> \\[   \\frac{dp}{dt} = -m(p - p_m)   \\] <ul> <li>Direction: toward (\\(p_m\\))</li> <li>Strength: proportional to distance from (\\(p_m\\))</li> <li>Shape: linear (no nonlinearity)</li> </ul> <p>Migration creates a single attractor in allele-frequency space.</p>"},{"location":"02_Processes/Migration/#7-two-population-symmetric-migration-preview","title":"7. Two-population symmetric migration (preview)","text":"<p>For two populations with symmetric migration rate (m):</p> \\[   \\begin{aligned}   \\frac{dp_1}{dt} &amp;= m(p_2 - p_1) \\\\   \\frac{dp_2}{dt} &amp;= m(p_1 - p_2)   \\end{aligned}   \\] <p>Properties:</p> <ul> <li>difference (\\(p_1 - p_2\\)) decays exponentially</li> <li>populations converge to a common frequency</li> <li>total mean frequency is conserved</li> </ul> <p>This introduces population structure without randomness.</p>"},{"location":"02_Processes/Migration/#8-migration-vs-mutation-important-comparison","title":"8. Migration vs mutation (important comparison)","text":"Aspect Mutation Migration Acts on alleles individuals / gametes Typical rate very small potentially large Source frequency implicit (\\(0/1\\)) explicit (\\(p_m\\)) Effect creates new variation redistributes variation Fixed point mutation\u2013selection balance source population <p>Migration can be seen as frequency-dependent mutation driven by other populations.</p>"},{"location":"02_Processes/Migration/#9-migration-vs-selection","title":"9. Migration vs selection","text":"Aspect Migration Selection Direction toward source frequency toward higher fitness Depends on fitness? no yes Nonlinearity linear generally nonlinear Creates adaptation? no yes Homogenizes populations yes no <p>Migration does not optimize fitness; it optimizes similarity.</p>"},{"location":"02_Processes/Migration/#10-migrationselection-balance-conceptual-preview","title":"10. Migration\u2013selection balance (conceptual preview)","text":"<p>When migration and selection act together:</p> <ul> <li>migration pulls allele frequencies toward the source</li> <li>selection pulls frequencies toward local optima</li> </ul> <p>Balance occurs when:</p> \\[   \\text{migration force} = \\text{selection force}   \\] <p>This explains:</p> <ul> <li>local adaptation</li> <li>clines</li> <li>tension zones</li> </ul> <p>(Details developed in later modules.)</p>"},{"location":"02_Processes/Migration/#11-what-migration-does-not-capture","title":"11. What migration does NOT capture","text":"<p>Migration models intentionally ignore:</p> <ul> <li>stochastic sampling (drift)</li> <li>ancestry and genealogies</li> <li>haplotype structure</li> <li>linkage disequilibrium</li> </ul> <p>These require:</p> <ul> <li>genetic drift</li> <li>recombination</li> <li>coalescent theory</li> </ul>"},{"location":"02_Processes/Migration/#12-conceptual-role-of-migration-in-population-genetics","title":"12. Conceptual role of migration in population genetics","text":"<p>Migration:</p> <ul> <li>introduces population structure deterministically</li> <li>counteracts divergence</li> <li>sets the stage for drift-based differentiation</li> <li>provides the backbone for (F_{ST}) theory</li> </ul> <p>Migration is the last purely deterministic process before entering stochastic population genetics.</p>"},{"location":"02_Processes/Migration/#links","title":"Links","text":"<ul> <li>Allele_frequency</li> <li>Frequency dynamics</li> <li>Mutation</li> <li>Selection(general)</li> <li>Selection_continuous</li> <li>Genetic drift</li> <li>Population_structure</li> </ul> <p>Migration is a deterministic homogenizing force that moves allele frequencies toward external sources, introducing population structure without stochasticity.</p>"},{"location":"02_Processes/Mutation/","title":"Mutation","text":""},{"location":"02_Processes/Mutation/#1-assumptions","title":"1. Assumptions","text":"<ul> <li>Single locus, two alleles \\(A\\) and \\(a\\)</li> <li>Forward mutation rate: \\(\u03bc (A \u2192 a)\\)</li> <li>Back mutation rate: \\(\u03bd (a \u2192 A)\\)</li> <li>Infinite population (no drift)</li> </ul>"},{"location":"02_Processes/Mutation/#2-update-rule","title":"2. Update rule","text":"<p>Let \\(p_t\\) be the frequency of allele \\(A\\) at generation \\(t\\).</p> <p>Then: $$ p_{t+1} = p_t (1 - \\mu) + (1 - p_t)\\nu $$</p>"},{"location":"02_Processes/Mutation/#3-interpretation","title":"3. Interpretation","text":"<ul> <li>First term: \\(A\\) alleles that do not mutate</li> <li>Second term: a alleles that mutate into \\(A\\)</li> </ul>"},{"location":"02_Processes/Mutation/#4-fixed-point","title":"4. Fixed point","text":"<p>Solve: $$ p_{t+1} = p_t $$</p> <p>Result: $$ p^* = \\frac{\\nu}{\\mu + \\nu} $$ The mutation\u2013mutation equilibrium is determined by balance of allele fluxes rather than fitness optimization.</p>"},{"location":"02_Processes/Mutation/#5-dynamics","title":"5. Dynamics","text":"<ul> <li>Linear map</li> <li>Globally stable equilibrium</li> <li>No fixation unless \u03bc = 0 or \u03bd = 0</li> </ul>"},{"location":"02_Processes/Mutation/#links","title":"Links","text":"<ul> <li>Allele_frequency</li> <li>Frequency dynamics</li> </ul>"},{"location":"02_Processes/Selection/Balancing_selection/","title":"Balancing selection","text":""},{"location":"02_Processes/Selection/Balancing_selection/#1-definition-dynamical-perspective","title":"1. Definition (dynamical perspective)","text":"<p>Balancing selection refers to a class of selective regimes in which allele frequency dynamics admit a stable internal equilibrium:</p> \\[ 0 &lt; p^* &lt; 1   \\] <p>In contrast to directional selection, balancing selection prevents fixation or loss, maintaining polymorphism over long evolutionary timescales.</p> <p>From a dynamical systems perspective, balancing selection corresponds to a stable fixed point inside the state space.</p>"},{"location":"02_Processes/Selection/Balancing_selection/#2-state-variable-and-dynamics","title":"2. State variable and dynamics","text":"<p>Let</p> <ul> <li>\\(p\\) = frequency of allele \\(A\\)</li> <li>\\(p \\in [0,1]\\)</li> </ul> <p>Allele frequency dynamics are described by:</p> \\[ \\frac{dp}{dt} = f(p)   \\] <p>Under balancing selection:</p> <ul> <li>\\(f(p) &gt; 0\\)  when \\(p &lt; p^*\\)</li> <li>\\(f(p) &lt; 0\\)  when \\(p &gt; p^*\\) </li> </ul> <p>Thus, trajectories are attracted toward ( \\(p^*\\) ).</p>"},{"location":"02_Processes/Selection/Balancing_selection/#3-phase-portrait-topological-view","title":"3. Phase portrait (topological view)","text":"<p>Balancing selection produces a single internal attractor:</p> <pre><code>0  -----&gt;  p*  &lt;-----  1\n</code></pre> <ul> <li>\\(p = 0\\), \\(p = 1\\): unstable fixed points</li> <li>\\(p = p^*\\): stable equilibrium</li> </ul> <p>This topology sharply contrasts with directional selection, where only boundary equilibria exist.</p>"},{"location":"02_Processes/Selection/Balancing_selection/#4-overdominance-heterozygote-advantage","title":"4. Overdominance (heterozygote advantage)","text":""},{"location":"02_Processes/Selection/Balancing_selection/#41-fitness-scheme","title":"4.1 Fitness scheme","text":"<p>The canonical form of balancing selection arises under overdominance:</p> \\[ \\begin{aligned}   w_{AA} &amp;= 1 - s_1 \\\\   w_{Aa} &amp;= 1 \\\\   w_{aa} &amp;= 1 - s_2   \\end{aligned}   \\] <p>where \\(s_1, s_2 &gt; 0\\).</p>"},{"location":"02_Processes/Selection/Balancing_selection/#42-internal-equilibrium","title":"4.2 Internal equilibrium","text":"<p>Solving\\(\\frac{dp}{dt} = 0\\) yields: $$ p^* = \\frac{s_2}{s_1 + s_2} $$</p> <p>This equilibrium is globally stable under deterministic dynamics.</p>"},{"location":"02_Processes/Selection/Balancing_selection/#43-interpretation","title":"4.3 Interpretation","text":"<ul> <li>Selection disfavors both homozygotes</li> <li>Rare alleles are protected</li> <li>Allele frequencies are \u201cpulled back\u201d toward the center</li> </ul> <p>This is the cleanest and most robust mechanism for balancing selection.</p>"},{"location":"02_Processes/Selection/Balancing_selection/#5-other-mechanisms-generating-balancing-selection","title":"5. Other mechanisms generating balancing selection","text":"<p>Balancing selection is a dynamical outcome, not a single biological mechanism.</p>"},{"location":"02_Processes/Selection/Balancing_selection/#51-frequency-dependent-selection","title":"5.1 Frequency-dependent selection","text":"<p>Fitness depends on allele frequency:</p> \\[   w_A = w_A(p), \\quad \\frac{dw_A}{dp} &lt; 0   \\] <ul> <li>Rare alleles enjoy higher fitness</li> <li>Common in host\u2013pathogen interactions and mating systems</li> </ul>"},{"location":"02_Processes/Selection/Balancing_selection/#52-spatial-or-temporal-heterogeneity","title":"5.2 Spatial or temporal heterogeneity","text":"<p>Different environments favor different alleles:</p> <ul> <li>Migration + local selection</li> <li>Temporal environmental fluctuations</li> </ul> <p>Averaging across space or time can generate a stable internal equilibrium.</p>"},{"location":"02_Processes/Selection/Balancing_selection/#6-coalescent-consequences","title":"6. Coalescent consequences","text":"<p>Balancing selection has distinct genealogical signatures:</p> <ul> <li>Extended coalescent times</li> <li>Deep genealogies near selected loci</li> <li>Maintenance of ancient allelic lineages</li> </ul> <p>This contrasts sharply with background selection, which shortens coalescent times.</p>"},{"location":"02_Processes/Selection/Balancing_selection/#7-statistical-signatures","title":"7. Statistical signatures","text":"<p>Balancing selection produces recognizable population-genetic patterns:</p> <ul> <li>Elevated nucleotide diversity \\(\u03c0\\)</li> <li>Excess of intermediate-frequency variants</li> <li>Positive Tajima\u2019s D</li> <li>Long-range LD around selected sites</li> </ul> <p>These signatures form the basis of balancing-selection scans.</p>"},{"location":"02_Processes/Selection/Balancing_selection/#8-relation-to-drift","title":"8. Relation to drift","text":"<p>In finite populations:</p> <ul> <li>Balancing selection counteracts drift</li> <li>Strong enough selection stabilizes polymorphism</li> <li>Weak balancing selection may be overwhelmed by drift</li> </ul> <p>Thus, persistence depends on the relative strength of: $$ N_e s $$</p>"},{"location":"02_Processes/Selection/Balancing_selection/#9-conceptual-contrast","title":"9. Conceptual contrast","text":"Regime Outcome Diversity Fixed points Directional selection Fixation \u2193 Boundary only Balancing selection Polymorphism \u2191 Internal stable Background selection Loss of variation \u2193\u2193 Boundary only"},{"location":"02_Processes/Selection/Balancing_selection/#10-conceptual-summary","title":"10. Conceptual summary","text":"<p>Balancing selection acts as a restoring force in allele-frequency space.</p> <p>It maintains genetic variation by introducing negative feedback on allele frequencies, fundamentally altering both dynamics and genealogies.</p>"},{"location":"02_Processes/Selection/Balancing_selection/#links","title":"Links","text":"<ul> <li>Overdominance</li> <li>Underdominace</li> <li>Selection_continuous</li> <li>Genetic drift</li> <li>Site_frequency_spectrum</li> <li>Coalescent_theory</li> </ul>"},{"location":"02_Processes/Selection/Dominance_selection/","title":"Dominance selection","text":""},{"location":"02_Processes/Selection/Dominance_selection/#1-what-is-dominance-selection","title":"1. What is dominance selection?","text":"<p>Dominance selection refers to selection in which the fitness of the heterozygote differs from that of both homozygotes.</p> <p>It describes how the phenotypic expression of alleles in heterozygotes modulates the action of selection across allele frequencies.</p> <p>Dominance does not change the direction of selection, but it profoundly alters its dynamics.</p>"},{"location":"02_Processes/Selection/Dominance_selection/#2-fitness-scheme-with-dominance","title":"2. Fitness scheme with dominance","text":"<p>For a single locus with two alleles (A) and (a):</p> \\[ \\begin{aligned}   w_{AA} &amp;= 1 \\\\   w_{Aa} &amp;= 1 - hs \\\\   w_{aa} &amp;= 1 - s   \\end{aligned}   \\] <p>where:</p> <ul> <li>\\(s\\) is the selection coefficient</li> <li>\\(h\\) is the dominance coefficient</li> </ul> <p>Special cases:</p> <ul> <li>\\(h = 0\\): complete dominance of \\(A\\)</li> <li>\\(h = 1/2\\): additive selection</li> <li>\\(h = 1\\): complete recessivity of \\(A\\)</li> </ul>"},{"location":"02_Processes/Selection/Dominance_selection/#3-discrete-time-allele-frequency-change","title":"3. Discrete-time allele frequency change","text":"<p>Under random mating and viability selection:</p> \\[ \\Delta p = \\frac{pq}{\\bar w}(w_A - w_a)   \\]"},{"location":"02_Processes/Selection/Dominance_selection/#with","title":"with:","text":"\\[ w_A - w_a = s\\big[(1-h) + (2h-1)p\\big]   \\] <p>This expression shows that dominance introduces frequency dependence into selection.</p>"},{"location":"02_Processes/Selection/Dominance_selection/#4-continuous-time-approximation","title":"4. Continuous-time approximation","text":"<p>Under weak selection, the continuous-time dynamics are:</p> \\[ \\boxed{   \\frac{dp}{dt} = s\\,p(1-p)\\Big[(1-h) + (2h-1)p\\Big]   }   \\] <p>This equation fully characterizes dominance selection as a nonlinear dynamical system.</p>"},{"location":"02_Processes/Selection/Dominance_selection/#5-low-frequency-behavior-visibility-of-selection","title":"5. Low-frequency behavior: visibility of selection","text":"<p>As \\(p \\to 0\\):</p> \\[ \\frac{dp}{dt}   \\approx   s(1-h)\\,p   \\] <p>Implications:</p> Dominance Low-frequency behavior \\(h &lt; 1\\) Selection acts immediately \\(h = 1\\) Selection is effectively neutral <p>Recessive beneficial alleles are invisible to selection when rare.</p> <p>This explains the slow initial spread of recessive advantageous mutations.</p>"},{"location":"02_Processes/Selection/Dominance_selection/#6-high-frequency-behavior","title":"6. High-frequency behavior","text":"<p>As \\(p \\to 1\\): $$ \\frac{dp}{dt} \\approx sh(1-p) $$</p> <p>Dominance effects diminish near fixation.</p> <p>Selection becomes efficient regardless of dominance once the allele is common.</p>"},{"location":"02_Processes/Selection/Dominance_selection/#7-fixed-points-and-phase-line-structure","title":"7. Fixed points and phase-line structure","text":"<p>For (\\(0 \\le h \\le 1\\)):</p> <ul> <li>Fixed points: (\\(p=0\\)), (\\(p=1\\))</li> <li>No internal equilibria</li> </ul> <p>Phase-line interpretation:</p> <ul> <li>\\(p=0\\): unstable</li> <li>\\(p=1\\): stable</li> </ul> <p>Dominance modifies the speed, not the direction, of evolution.</p>"},{"location":"02_Processes/Selection/Dominance_selection/#8-dominance-vs-additive-selection","title":"8. Dominance vs additive selection","text":"<p>Additive selection \\(h=1/2\\) serves as a baseline:</p> <ul> <li>symmetric allele contribution</li> <li>linear phenotype\u2013genotype relationship</li> </ul> <p>Dominance introduces asymmetry:</p> <ul> <li>early dynamics differ</li> <li>fixation time depends strongly on \\(h\\)</li> </ul>"},{"location":"02_Processes/Selection/Dominance_selection/#9-biological-interpretation","title":"9. Biological interpretation","text":"<p>Dominance reflects:</p> <ul> <li>gene regulation</li> <li>protein dosage</li> <li>metabolic buffering</li> <li>developmental thresholds</li> </ul> <p>It connects molecular biology to population-level dynamics.</p>"},{"location":"02_Processes/Selection/Dominance_selection/#10-conceptual-role-of-dominance-selection","title":"10. Conceptual role of dominance selection","text":"<p>Dominance selection shows that:</p> <ul> <li>selection strength is frequency dependent</li> <li>visibility matters more than ultimate advantage</li> <li>early stochastic effects (drift) interact strongly with dominance</li> </ul> <p>This prepares the ground for:</p> <ul> <li>overdominance</li> <li>underdominance</li> <li>mutation\u2013selection balance with dominance</li> </ul>"},{"location":"02_Processes/Selection/Dominance_selection/#links","title":"Links","text":"<ul> <li>Selection(general)</li> <li>Fitness_scheme</li> <li>Selection_continuous</li> <li>Mutation_selection_balance</li> <li>Overdominance</li> <li>Underdominace</li> <li>Genetic drift</li> </ul> <p>Dominance controls when selection becomes visible, not where evolution ultimately goes.</p>"},{"location":"02_Processes/Selection/Fitness_scheme/","title":"Fitness scheme","text":""},{"location":"02_Processes/Selection/Fitness_scheme/#1-what-is-a-fitness-scheme","title":"1. What is a fitness scheme?","text":"<p>A fitness scheme specifies how different genotypes contribute to the next generation. It translates biological assumptions about survival or reproduction into relative weights, which in turn define the direction and strength of allele frequency dynamics.</p> <p>Fitness schemes are not empirical measurements of survival probability, but relative fitness values used to construct a dynamical system.</p> <p>In population genetics, the fitness scheme acts as the interface between:</p> <ul> <li>biological assumptions</li> <li>mathematical formulation</li> <li>dynamical behavior of allele frequencies</li> </ul>"},{"location":"02_Processes/Selection/Fitness_scheme/#2-viability-selection-framework","title":"2. Viability selection framework","text":"<p>In the viability selection model:</p> <ul> <li>selection acts between zygote formation and adulthood</li> <li>genotypes differ in their probability of surviving to reproduce</li> <li>population size is implicitly rescaled each generation</li> </ul> <p>Let the genotype fitnesses be:</p> \\[ w_{AA},; w_{Aa},; w_{aa}   \\] <p>These values are relative, meaning that multiplying all fitnesses by a constant does not change the dynamics.</p>"},{"location":"02_Processes/Selection/Fitness_scheme/#3-canonical-parameterization-single-locus-two-allele","title":"3. Canonical parameterization (single-locus, two-allele)","text":"<p>A widely used and highly informative parameterization is:</p> \\[ \\begin{aligned} w_{AA} &amp;= 1 \\\\ w_{Aa} &amp;= 1 - hs \\\\ w_{aa} &amp;= 1 - s \\end{aligned} \\] <p>where:</p> <ul> <li>\\(s\\) = selection coefficient (strength of selection)</li> <li>\\(h\\) = dominance coefficient (how heterozygotes compare to homozygotes)</li> </ul> <p>This parameterization captures most classical selection models by varying \\(h\\).</p>"},{"location":"02_Processes/Selection/Fitness_scheme/#4-interpretation-of-parameters","title":"4. Interpretation of parameters","text":""},{"location":"02_Processes/Selection/Fitness_scheme/#selection-coefficient-s","title":"Selection coefficient \\(s\\)","text":"<ul> <li>Measures the fitness disadvantage of genotype \\(aa\\)</li> <li>\\(s = 0\\): no selection</li> <li>Larger \\(s\\): stronger selection against \\(aa\\)</li> </ul>"},{"location":"02_Processes/Selection/Fitness_scheme/#dominance-coefficient-h","title":"Dominance coefficient \\(h\\)","text":"<p>Controls how the heterozygote compares to homozygotes:</p> \\(h\\) Interpretation 0 complete dominance of \\(A\\) 1/2 additive (codominant) 1 complete recessivity of \\(A\\) &lt; 0 overdominance (heterozygote advantage) &gt; 1 underdominance (heterozygote disadvantage) <p>Thus, (\\(h\\)) determines the qualitative structure of the dynamics, not just the speed.</p>"},{"location":"02_Processes/Selection/Fitness_scheme/#5-special-cases-and-their-biological-meaning","title":"5. Special cases and their biological meaning","text":""},{"location":"02_Processes/Selection/Fitness_scheme/#51-complete-dominance-h-0","title":"5.1 Complete dominance (h = 0)","text":"\\[  w_{AA} = w_{Aa} = 1,\\quad w_{aa} = 1 - s   \\] <ul> <li>Heterozygotes express the beneficial allele</li> <li>Selection is effective even at low allele frequency</li> <li>(\\(dp/dt \\propto sp\\))</li> </ul> <p>Biological meaning: The beneficial allele is visible to selection immediately.</p>"},{"location":"02_Processes/Selection/Fitness_scheme/#52-additive-selection-h-12","title":"5.2 Additive selection (h = 1/2)","text":"\\[ w_{Aa} = \\frac{w_{AA} + w_{aa}}{2}   \\] <ul> <li>Most commonly used textbook model</li> <li>Symmetric contribution of alleles</li> <li>Smooth allele frequency change</li> </ul> <p>Biological meaning: Phenotype changes approximately linearly with allele dosage.</p>"},{"location":"02_Processes/Selection/Fitness_scheme/#53-complete-recessivity-h-1","title":"5.3 Complete recessivity (h = 1)","text":"\\[ w_{Aa} = w_{aa}   \\] <ul> <li>Beneficial allele hidden in heterozygotes</li> <li>Very slow increase when rare</li> <li>(\\(dp/dt \\propto sp^2\\))</li> </ul> <p>Biological meaning: Recessive advantageous mutations struggle to escape low frequency.</p>"},{"location":"02_Processes/Selection/Fitness_scheme/#6-fitness-scheme-as-a-force-field","title":"6. Fitness scheme as a force field","text":"<p>Once a fitness scheme is specified, allele frequency dynamics can be viewed as motion in a force field:</p> \\[ \\frac{dp}{dt} = F(p)   \\] <ul> <li>(\\(p\\)): allele A frequency</li> <li>(\\(F(p)\\)): selection-induced force</li> </ul> <p>Fixed points satisfy: $$ F(p) = 0 $$</p> <p>The stability of these points depends entirely on the fitness scheme.</p> <p>Fitness schemes define the topology of the phase portrait.</p>"},{"location":"02_Processes/Selection/Fitness_scheme/#7-fixed-points-and-their-meaning","title":"7. Fixed points and their meaning","text":"<p>For simple directional selection:</p> <ul> <li>\\(p = 0\\): loss of allele A</li> <li>\\(p = 1\\): fixation of allele A</li> </ul> <p>Stability interpretation:</p> <ul> <li>Stable: system returns after perturbation</li> <li>Unstable: any perturbation drives system away</li> </ul> <p>\u26a0\ufe0f Important clarification: An unstable fixed point (e.g. \\(p=0\\)) does not mean population extinction \u2014 it only means the allele frequency state is unstable.</p>"},{"location":"02_Processes/Selection/Fitness_scheme/#8-what-fitness-schemes-do-not-capture","title":"8. What fitness schemes do NOT capture","text":"<p>Fitness schemes intentionally ignore:</p> <ul> <li>linkage and LD</li> <li>individual ancestry</li> <li>genotype phase</li> <li>finite population stochasticity</li> </ul> <p>These effects are handled by:</p> <ul> <li>drift models</li> <li>multi-locus models</li> <li>coalescent theory</li> </ul> <p>Thus, fitness schemes are controlled abstractions, not complete descriptions.</p>"},{"location":"02_Processes/Selection/Fitness_scheme/#9-role-of-fitness-schemes-in-population-genetics","title":"9. Role of fitness schemes in population genetics","text":"<p>Fitness schemes:</p> <ul> <li>define selection models</li> <li>determine equilibrium structure</li> <li>predict fixation vs polymorphism</li> <li>connect biology to dynamical systems</li> </ul> <p>They are the starting point for:</p> <ul> <li>mutation\u2013selection balance</li> <li>balancing selection</li> <li>selective sweeps</li> <li>phase-plane analysis</li> </ul>"},{"location":"02_Processes/Selection/Fitness_scheme/#links","title":"Links","text":"<ul> <li>Selection(general)</li> <li>Allele_frequency</li> <li>Frequency dynamics</li> <li>Mutation</li> <li>Mutation_selection_balance</li> </ul>"},{"location":"02_Processes/Selection/Mutation_selection_balance/","title":"Mutation\u2013selection balance","text":""},{"location":"02_Processes/Selection/Mutation_selection_balance/#1-conceptual-overview","title":"1. Conceptual overview","text":"<p>Mutation\u2013selection balance describes the long-term equilibrium that arises when:</p> <ul> <li>selection removes deleterious alleles, and</li> <li>mutation continuously introduces them.</li> </ul> <p>Rather than leading to fixation or loss, the system settles at an internal stable equilibrium, where opposing evolutionary forces balance.</p> <p>Selection is a directional force. Mutation is a restorative force. Their competition defines a stable allele-frequency attractor.</p>"},{"location":"02_Processes/Selection/Mutation_selection_balance/#2-why-selection-alone-is-insufficient","title":"2. Why selection alone is insufficient","text":"<p>In a pure selection model:</p> <ul> <li>boundary states \\(p=0, p=1\\)are the only equilibria,</li> <li>advantageous alleles fix,</li> <li>deleterious alleles are eliminated.</li> </ul> <p>However, empirical populations show:</p> <ul> <li>persistent deleterious variation,</li> <li>incomplete purging,</li> <li>stable polymorphism at low frequency.</li> </ul> <p>Mutation is required to maintain genetic variation.</p>"},{"location":"02_Processes/Selection/Mutation_selection_balance/#3-continuous-time-formulation","title":"3. Continuous-time formulation","text":"<p>Let:</p> <ul> <li>\\(p\\): frequency of allele \\(A\\)</li> <li>\\(\\mu\\): mutation rate \\(A \\to a\\)</li> <li>\\(\\nu\\): mutation rate \\(a \\to A\\)</li> </ul>"},{"location":"02_Processes/Selection/Mutation_selection_balance/#mutation-contribution","title":"Mutation contribution","text":"\\[ \\left.\\frac{dp}{dt}\\right|_{\\text{mutation}} = \\nu(1-p) - \\mu p   \\] <p>This term:</p> <ul> <li>increases (\\(p\\)) via back-mutation,</li> <li>decreases (\\(p\\)) via forward mutation.</li> </ul>"},{"location":"02_Processes/Selection/Mutation_selection_balance/#4-selection-term-from-continuous-limit","title":"4. Selection term (from continuous limit)","text":"<p>From <code>Selection_continuous.md</code>, under viability selection with dominance:</p> <p>$$ \\left.\\frac{dp}{dt}\\right|_{\\text{selection}}</p> <p>=s\\,p(1-p)\\Big[(1-h)+(2h-1)p\\Big] $$</p>"},{"location":"02_Processes/Selection/Mutation_selection_balance/#5-full-mutationselection-dynamics","title":"5. Full mutation\u2013selection dynamics","text":"<p>By superposition of forces:</p> <p>$$ \\boxed{ \\frac{dp}{dt}</p> <p>=s\\,p(1-p)\\Big[(1-h)+(2h-1)p\\Big] + \\nu(1-p) - \\mu p } $$</p> <p>This is a one-dimensional nonlinear dynamical system with mutation and selection acting simultaneously.</p>"},{"location":"02_Processes/Selection/Mutation_selection_balance/#6-classical-case-recessive-deleterious-allele","title":"6. Classical case: recessive deleterious allele","text":"<p>This is the canonical textbook model underlying purifying selection.</p>"},{"location":"02_Processes/Selection/Mutation_selection_balance/#assumptions","title":"Assumptions","text":"<ul> <li>allele (\\(a\\)) is deleterious</li> <li>allele (\\(A\\)) is wild type</li> <li>complete recessivity: (\\(h = 0\\))</li> <li>no back-mutation: (\\(\\nu = 0\\))</li> </ul> <p>Fitness scheme:</p> \\[ w_{AA} = 1\\,\\quad   w_{Aa} = 1\\,\\quad   w_{aa} = 1 - s   \\]"},{"location":"02_Processes/Selection/Mutation_selection_balance/#7-dynamical-equation","title":"7. Dynamical equation","text":"<p>Under these assumptions:</p>"},{"location":"02_Processes/Selection/Mutation_selection_balance/#selection-term","title":"Selection term","text":"<p>$$ \\left.\\frac{dp}{dt}\\right|_{\\text{selection}}</p> <p>s,p(1-p)^2 $$</p>"},{"location":"02_Processes/Selection/Mutation_selection_balance/#mutation-term","title":"Mutation term","text":"\\[ \\left.\\frac{dp}{dt}\\right|_{\\text{mutation}} = -\\mu p   \\]"},{"location":"02_Processes/Selection/Mutation_selection_balance/#combined-system","title":"Combined system","text":"\\[ \\boxed{   \\frac{dp}{dt} = s\\,p(1-p)^2 - \\mu p   }   \\]"},{"location":"02_Processes/Selection/Mutation_selection_balance/#8-solving-for-the-equilibrium","title":"8. Solving for the equilibrium","text":"<p>At equilibrium (\\(p^*\\)):</p> \\[ \\frac{dp}{dt} = 0   \\] <p>Assuming (\\(p^* \\neq 0\\)):</p> \\[ s(1-p^*)^2 = \\mu   \\] <p>Solving: $$ \\boxed{ p^ = 1 - \\sqrt{\\frac{\\mu}{s}} } ] $$ This is the mutation\u2013selection balance frequency*.</p>"},{"location":"02_Processes/Selection/Mutation_selection_balance/#9-interpretation-of-the-equilibrium","title":"9. Interpretation of the equilibrium","text":""},{"location":"02_Processes/Selection/Mutation_selection_balance/#91-persistence-of-deleterious-alleles","title":"9.1 Persistence of deleterious alleles","text":"<p>Even with strong selection ((\\(s \\gg \\mu\\))):</p> <ul> <li>deleterious alleles are not eliminated,</li> <li>they persist at low frequency.</li> </ul> <p>Selection reduces frequency, mutation prevents extinction.</p>"},{"location":"02_Processes/Selection/Mutation_selection_balance/#92-dependence-on-mus","title":"9.2 Dependence on (\\(\\mu/s\\))","text":"<p>The equilibrium depends only on:</p> \\[ \\frac{\\mu}{s}   \\] <ul> <li>independent of population size,</li> <li>independent of initial frequency,</li> <li>determined by force balance.</li> </ul>"},{"location":"02_Processes/Selection/Mutation_selection_balance/#93-stability","title":"9.3 Stability","text":"<p>The equilibrium (\\(p^*\\)) is stable:</p> <ul> <li>if (\\(p &gt; p^*\\)): selection dominates \u2192 (\\(p\\)) decreases</li> <li>if (\\(p &lt; p^*\\)): mutation dominates \u2192 (\\(p\\)) increases</li> </ul> <p>Thus, (\\(p^*\\)) is a genuine attractor in allele-frequency space.</p>"},{"location":"02_Processes/Selection/Mutation_selection_balance/#10-phase-line-interpretation","title":"10. Phase-line interpretation","text":"<p>The force field now has a new topology:</p> <pre><code>p=0      p*                  p=1\n|  \u2192 \u2192 \u2192  \u25cf  \u2190 \u2190 \u2190           |\n        stable\n</code></pre> <ul> <li>boundary fixation is prevented,</li> <li>an internal equilibrium emerges,</li> <li>long-term polymorphism is maintained.</li> </ul> <p>This marks a qualitative transition from pure selection dynamics.</p>"},{"location":"02_Processes/Selection/Mutation_selection_balance/#11-conceptual-significance","title":"11. Conceptual significance","text":"<p>Mutation\u2013selection balance shows that:</p> <ul> <li>evolution does not necessarily optimize fitness,</li> <li>equilibrium can occur away from fitness maxima,</li> <li>genetic load is an inevitable consequence of mutation.</li> </ul> <p>Purifying selection does not eliminate deleterious alleles \u2014 it confines them to a low-frequency equilibrium.</p>"},{"location":"02_Processes/Selection/Mutation_selection_balance/#12-extensions-and-generalizations","title":"12. Extensions and generalizations","text":"<p>This framework naturally extends to:</p> <ul> <li>partial dominance ((\\(h \\neq 0\\)))</li> <li>back-mutation ((\\(\\nu &gt; 0\\)))</li> <li>multiple loci (background selection)</li> <li>diffusion approximations with drift</li> </ul> <p>Mutation\u2013selection balance forms the theoretical backbone of:</p> <ul> <li>genetic load theory,</li> <li>nearly neutral evolution,</li> <li>low-frequency variant architecture in GWAS.</li> </ul>"},{"location":"02_Processes/Selection/Mutation_selection_balance/#links","title":"Links","text":"<ul> <li>Selection(general)</li> <li>Selection_continuous</li> <li>Fitness_scheme</li> <li>Mutation</li> <li>Allele_frequency</li> <li>Background_selection</li> </ul>"},{"location":"02_Processes/Selection/Overdominance/","title":"Overdominance","text":""},{"location":"02_Processes/Selection/Overdominance/#1-definition-of-overdominance","title":"1. Definition of overdominance","text":"<p>Overdominance (heterozygote advantage) occurs when the heterozygote has higher fitness than both homozygotes:</p> \\[ \\boxed{   w_{Aa} &gt; w_{AA}, \\quad w_{Aa} &gt; w_{aa}   }   \\] <p>This is a definition based on fitness ranking, not parameter values.</p> <p>Overdominance represents a qualitative shift in selection dynamics:</p> <ul> <li>the fitness optimum lies inside allele-frequency space,</li> <li>not at the boundaries.</li> </ul>"},{"location":"02_Processes/Selection/Overdominance/#2-canonical-fitness-scheme","title":"2. Canonical fitness scheme","text":"<p>A standard parameterization is:</p> \\[   \\begin{aligned}   w_{AA} &amp;= 1 - s \\\\   w_{Aa} &amp;= 1 \\\\   w_{aa} &amp;= 1 - t   \\end{aligned}   \\quad (s&gt;0,; t&gt;0)   \\] <p>Here:</p> <ul> <li>both homozygotes are selected against,</li> <li>the heterozygote is optimal.</li> </ul>"},{"location":"02_Processes/Selection/Overdominance/#3-allele-frequency-dynamics","title":"3. Allele-frequency dynamics","text":"<p>Under random mating and viability selection, the change in allele frequency is:</p> \\[ \\Delta p = \\frac{pq}{\\bar w}(w_A - w_a)   \\] <p>For the above fitness scheme, selection becomes frequency dependent.</p> <p>In the weak-selection, continuous-time limit:</p> \\[  \\boxed{   \\frac{dp}{dt} = p(1-p)\\big[t - (s+t)p\\big]   }   \\] <p>This nonlinear equation defines the overdominance dynamics.</p>"},{"location":"02_Processes/Selection/Overdominance/#4-fixed-points","title":"4. Fixed points","text":"<p>Solving (\\(\\frac{dp}{dt}=0\\)) yields three equilibria:</p> <ul> <li>(\\(p=0\\))</li> <li>(\\(p=1\\))</li> <li>internal equilibrium:     $$     \\boxed{     p^* = \\frac{t}{s+t}     }     $$</li> </ul> <p>The internal equilibrium lies strictly between 0 and 1.</p>"},{"location":"02_Processes/Selection/Overdominance/#5-stability-analysis","title":"5. Stability analysis","text":""},{"location":"02_Processes/Selection/Overdominance/#boundary-points","title":"Boundary points","text":"<ul> <li> <p>Near (\\(p=0\\)):     $$     \\frac{dp}{dt} \\approx tp &gt; 0     $$      \u2192 (\\(p=0\\)) is unstable</p> </li> <li> <p>Near (\\(p=1\\)):     $$     \\frac{dp}{dt} \\approx -s(1-p) &lt; 0     $$      \u2192 (p=1) is unstable</p> </li> </ul>"},{"location":"02_Processes/Selection/Overdominance/#internal-equilibrium","title":"Internal equilibrium","text":"<p>At (\\(p^*\\)):</p> <ul> <li>if (\\(p &lt; p^*\\)): (\\(\\frac{dp}{dt} &gt; 0\\))</li> <li>if (\\(p &gt; p^*\\)): (\\(\\frac{dp}{dt} &lt; 0\\))</li> </ul> <p>Thus:</p> \\[ \\boxed{   p^* \\text{ is a stable internal equilibrium}   }   \\]"},{"location":"02_Processes/Selection/Overdominance/#6-phase-line-interpretation","title":"6. Phase-line interpretation","text":"<p>The overdominance phase line has the structure:</p> <pre><code>0  \u2190\u2014\u2014\u2014  \u25cf  \u2014\u2014\u2014\u2192  1\n       stable\n</code></pre> <p>Interpretation:</p> <ul> <li>selection pushes allele frequencies away from boundaries,</li> <li>trajectories converge toward the internal attractor.</li> </ul> <p>This is the first case where selection alone maintains polymorphism.</p>"},{"location":"02_Processes/Selection/Overdominance/#7-mechanistic-interpretation-key-insight","title":"7. Mechanistic interpretation (key insight)","text":"<p>The core mechanism of overdominance is:</p> <p>The rarer allele is more likely to occur in heterozygotes, which have the highest fitness.</p> <p>Thus:</p> <ul> <li>when allele (\\(A\\)) is rare, it is favored;</li> <li>when allele (\\(a\\)) is rare, it is favored.</li> </ul> <p>This creates negative frequency-dependent selection.</p>"},{"location":"02_Processes/Selection/Overdominance/#8-comparison-with-dominance-selection","title":"8. Comparison with dominance selection","text":"Feature Dominance selection Overdominance Fitness optimum boundary interior Direction of selection unidirectional bidirectional Internal equilibrium none stable Maintains polymorphism no yes Requires mutation no no <p>Overdominance represents a topological change in the selection landscape.</p>"},{"location":"02_Processes/Selection/Overdominance/#9-relation-to-mutationselection-balance","title":"9. Relation to mutation\u2013selection balance","text":"<p>Important distinction:</p> <ul> <li> <p>mutation\u2013selection balance:     equilibrium arises from opposing forces</p> </li> <li> <p>overdominance:     equilibrium arises from selection alone</p> </li> </ul> <p>Thus, overdominance is an intrinsic balancing selection mechanism.</p>"},{"location":"02_Processes/Selection/Overdominance/#10-biological-relevance-and-examples","title":"10. Biological relevance and examples","text":"<p>Classic examples include:</p> <ul> <li>sickle-cell polymorphism in malaria-endemic regions</li> <li>MHC diversity</li> <li>loci contributing to heterosis</li> </ul> <p>Note:</p> <p>heterozygote advantage at the phenotypic level does not always imply single-locus overdominance.</p>"},{"location":"02_Processes/Selection/Overdominance/#11-conceptual-role-in-population-genetics","title":"11. Conceptual role in population genetics","text":"<p>Overdominance demonstrates that:</p> <ul> <li>selection does not always eliminate variation,</li> <li>equilibrium does not necessarily correspond to fixation,</li> <li>frequency-dependent effects can stabilize diversity.</li> </ul> <p>It is the canonical model of balancing selection.</p>"},{"location":"02_Processes/Selection/Overdominance/#links","title":"Links","text":"<ul> <li>Dominance_selection</li> <li>Selection(general)</li> <li>Selection_continuous</li> <li>Mutation_selection_balance</li> <li>Underdominace</li> <li>Genetic drift</li> <li>Balancing_selection</li> </ul> <p>Overdominance produces a stable internal equilibrium because the fitness maximum lies in heterozygotes, creating negative frequency-dependent selection that favors rare alleles.</p>"},{"location":"02_Processes/Selection/Selection%28general%29/","title":"Overview","text":""},{"location":"02_Processes/Selection/Selection%28general%29/#1-assumptions","title":"1. Assumptions","text":"<ul> <li>Infinite population</li> <li>Random mating</li> <li>No mutation, no migration</li> <li>Viability selection</li> </ul>"},{"location":"02_Processes/Selection/Selection%28general%29/#2-fitness-scheme","title":"2. Fitness scheme","text":"<p>In a viability selection model, fitness represents relative survival from zygote to adulthood, not absolute survival probability. Genotypes with lower fitness contribute proportionally fewer individuals to the next generation. Let genotype fitnesses be:</p> <ul> <li>\\(w_{AA} = 1\\)</li> <li>\\(w_{Aa} = 1\\)</li> <li>\\(w_{aa} = 1 - s\\)</li> </ul>"},{"location":"02_Processes/Selection/Selection%28general%29/#3-update-rule","title":"3. Update rule","text":"<p>Let \\(p_t\\) be allele \\(A\\) frequency at generation \\(t\\).</p> <p>After selection: $$ p_{t+1} = \\frac{p_t}{1 - s(1 - p_t)^2} $$</p>"},{"location":"02_Processes/Selection/Selection%28general%29/#4-fixed-points","title":"4. Fixed points","text":"<p>Solve \\(p_{t+1} = p_t\\):</p> <ul> <li>\\(p = 0\\)</li> <li>\\(p = 1\\)</li> </ul>"},{"location":"02_Processes/Selection/Selection%28general%29/#5-stability","title":"5. Stability","text":"<ul> <li>\\(p = 1\\) is stable</li> <li>\\(p = 0\\) is unstable (if \\(s &gt; 0\\))</li> </ul> <p>\\(p = 0\\) is an unstable fixed point under positive selection, meaning that any introduction of the beneficial allele will drive the system away from this state.</p>"},{"location":"02_Processes/Selection/Selection%28general%29/#6-interpretation","title":"6. Interpretation","text":"<p>Selection drives allele frequency toward fixation of the beneficial allele.</p>"},{"location":"02_Processes/Selection/Selection%28general%29/#links","title":"Links","text":"<ul> <li>Allele_frequency</li> <li>Frequency dynamics</li> <li>Dominance_selection</li> <li>Overdominance</li> </ul>"},{"location":"02_Processes/Selection/Selection_continuous/","title":"Continuous selection","text":""},{"location":"02_Processes/Selection/Selection_continuous/#1-motivation-why-continuous-time","title":"1. Motivation: why continuous time?","text":"<p>Classical population genetics is often formulated in discrete generations:</p> \\[ p_{t+1} = f(p_t)   \\] <p>However, for understanding: - stability, - local behavior near boundaries, - dominance effects at low frequency, - and the geometric structure of selection, </p> <p>it is useful to consider a continuous-time approximation.</p> <p>The continuous-time limit does not replace the discrete model; it provides a local, first-order description of allele-frequency change under weak selection.</p>"},{"location":"02_Processes/Selection/Selection_continuous/#2-assumptions-of-the-continuous-time-limit","title":"2. Assumptions of the continuous-time limit","text":"<p>The derivation relies on three key assumptions:</p> <ol> <li> <p>Weak selection     $$     s \\ll 1     $$</p> </li> <li> <p>Small per-generation change     $$      |p_{t+1} - p_t| \\ll 1     $$</p> </li> <li> <p>*Time measured in generations can be treated continuously</p> </li> </ol> <p>Under these conditions, the finite difference can be approximated by a derivative:</p> \\[   p_{t+1} - p_t \\;\\approx\\; \\frac{dp}{dt}   \\]"},{"location":"02_Processes/Selection/Selection_continuous/#3-starting-point-discrete-selection-dynamics","title":"3. Starting point: discrete selection dynamics","text":"<p>Consider a single-locus, two-allele system under viability selection with dominance:</p> \\[   \\begin{aligned}   w_{AA} &amp;= 1 \\\\   w_{Aa} &amp;= 1 - hs \\\\   w_{aa} &amp;= 1 - s   \\end{aligned}   \\] <p>Let \\((p)\\) be the frequency of allele (\\(A\\)), and (\\(q = 1 - p\\)).</p> <p>A general identity for allele-frequency change under selection is:</p> \\[ \\Delta p   = p_{t+1} - p_t   = \\frac{pq}{\\bar w}\\,(w_A - w_a)   \\] <p>where:</p> <ul> <li>(\\(w_A\\)) and (\\(w_a\\)) are the average fitnesses of alleles,</li> <li>(\\(\\bar w\\)) is the mean population fitness.</li> </ul>"},{"location":"02_Processes/Selection/Selection_continuous/#4-allelic-fitness-difference","title":"4. Allelic fitness difference","text":"<p>Under the above fitness scheme, the difference in allelic fitness is:</p> \\[ w_A - w_a   = s\\Big[(1-h) + (2h-1)p\\Big]   \\] <p>This term encodes the dominance structure of selection.</p>"},{"location":"02_Processes/Selection/Selection_continuous/#5-weak-selection-approximation","title":"5. Weak-selection approximation","text":"<p>Under weak selection:</p> \\[ \\bar w = 1 - \\mathcal{O}(s)   \\quad\\Rightarrow\\quad   \\frac{1}{\\bar w} \\approx 1   \\] <p>Thus, to first order in (s):</p> \\[ \\Delta p   \\approx   s\\,p(1-p)\\Big[(1-h) + (2h-1)p\\Big]   \\]"},{"location":"02_Processes/Selection/Selection_continuous/#6-continuous-time-selection-equation","title":"6. Continuous-time selection equation","text":"<p>Replacing the finite difference by a derivative yields the continuous-time model:</p> \\[ \\boxed{   \\frac{dp}{dt}= s\\,p(1-p)\\Big[(1-h) + (2h-1)p\\Big]   }   \\] <p>This equation defines a one-dimensional nonlinear dynamical system on the interval (\\(p \\in [0,1]\\)).</p>"},{"location":"02_Processes/Selection/Selection_continuous/#7-interpretation-of-the-terms","title":"7. Interpretation of the terms","text":""},{"location":"02_Processes/Selection/Selection_continuous/#71-the-factor-p1-p","title":"7.1 The factor (\\(p(1-p)\\))","text":"<ul> <li>Selection requires genetic variation</li> <li>When (\\(p = 0\\)) or (\\(p = 1\\)), no variation exists</li> <li>Therefore, boundary points are always equilibria</li> </ul> <p>This structure is independent of the fitness scheme.</p>"},{"location":"02_Processes/Selection/Selection_continuous/#72-dominance-and-low-frequency-behavior","title":"7.2 Dominance and low-frequency behavior","text":"<p>As (\\(p \\to 0\\)):</p> \\[ \\frac{dp}{dt} \\approx s(1-h)\\,p   \\] <p>Consequences:</p> <ul> <li>(\\(h &lt; 1\\)): selection is effective at low frequency</li> <li>(\\(h = 1\\)): selection is invisible when rare</li> </ul> <p>Recessive beneficial alleles behave nearly neutrally at low frequency.</p>"},{"location":"02_Processes/Selection/Selection_continuous/#73-high-frequency-behavior","title":"7.3 High-frequency behavior","text":"<p>As (\\(p \\to 1\\)):</p> \\[ \\frac{dp}{dt} \\approx s h (1-p)   \\] <p>Dominance effects diminish near fixation.</p>"},{"location":"02_Processes/Selection/Selection_continuous/#8-fixed-points-and-stability","title":"8. Fixed points and stability","text":"<p>The fixed points satisfy:</p> \\[ \\frac{dp}{dt} = 0   \\] <p>For directional selection ((\\(0 \\le h \\le 1\\))):</p> <ul> <li>(\\(p^* = 0\\)) \u2014 unstable</li> <li>(\\(p^* = 1\\)) \u2014 stable</li> </ul> <p>Interpretation:</p> <ul> <li>Instability of (p=0) means loss of robustness to perturbation</li> <li>It does not imply population extinction</li> </ul>"},{"location":"02_Processes/Selection/Selection_continuous/#9-phase-line-interpretation","title":"9. Phase-line interpretation","text":"<p>The continuous equation defines a force field on allele-frequency space.</p> <p>For (\\(0 &lt; p &lt; 1\\)) and (\\(0 \\le h \\le 1\\)): $$ \\frac{dp}{dt} &gt; 0 $$</p> <p>Thus:</p> <ul> <li>trajectories flow monotonically from (\\(p=0\\)) to (\\(p=1\\))</li> <li>selection produces fixation dynamics</li> </ul> <p>The phase line summarizes this behavior geometrically.</p>"},{"location":"02_Processes/Selection/Selection_continuous/#10-conceptual-significance","title":"10. Conceptual significance","text":"<p>The continuous-time limit reveals that:</p> <ul> <li>selection acts as a deterministic force</li> <li>dominance controls visibility, not direction</li> <li>fixation is a global property of the force field</li> <li>mutation or drift are required to generate interior equilibria</li> </ul> <p>This formulation provides the natural foundation for:</p> <ul> <li>mutation\u2013selection balance</li> <li>diffusion approximations</li> <li>fitness landscapes and potential functions</li> </ul>"},{"location":"02_Processes/Selection/Selection_continuous/#links","title":"Links","text":"<ul> <li>Selection(general)</li> <li>Fitness_scheme</li> <li>Allele_frequency</li> <li>Frequency dynamics</li> <li>Mutation_selection_balance</li> </ul>"},{"location":"02_Processes/Selection/Underdominace/","title":"Underdominance","text":""},{"location":"02_Processes/Selection/Underdominace/#1-definition-of-underdominance","title":"1. Definition of underdominance","text":"<p>Underdominance (heterozygote disadvantage) occurs when the heterozygote has lower fitness than both homozygotes:</p> \\[ \\boxed{   w_{Aa} &lt; w_{AA}, \\quad w_{Aa} &lt; w_{aa}   }   \\] <p>In contrast to overdominance, the heterozygote represents a fitness minimum, not a maximum.</p> <p>Underdominance produces threshold dynamics and an unstable internal equilibrium.</p>"},{"location":"02_Processes/Selection/Underdominace/#2-canonical-fitness-scheme","title":"2. Canonical fitness scheme","text":"<p>A commonly used symmetric parameterization is:</p> \\[   \\begin{aligned}   w_{AA} &amp;= 1 \\\\   w_{Aa} &amp;= 1 - s \\\\   w_{aa} &amp;= 1   \\end{aligned}   \\quad (s&gt;0)   \\] <p>Here:</p> <ul> <li>both homozygotes have equal fitness,</li> <li>the heterozygote is selected against.</li> </ul> <p>An asymmetric generalization is:</p> \\[ \\begin{aligned}   w_{AA} &amp;= 1 \\\\   w_{Aa} &amp;= 1 - s \\\\   w_{aa} &amp;= 1 - t   \\end{aligned}   \\] <p>with (\\(s,t&gt;0\\)).</p>"},{"location":"02_Processes/Selection/Underdominace/#3-allele-frequency-dynamics","title":"3. Allele-frequency dynamics","text":"<p>Under random mating and viability selection, allele-frequency change follows:</p> \\[  \\Delta p = \\frac{pq}{\\bar w}(w_A - w_a)   \\] <p>In the weak-selection, continuous-time limit, the dynamics take the form:</p> \\[  \\boxed{   \\frac{dp}{dt} = p(1-p)\\,G(p)   }   \\] <p>where (\\(G(p)\\)) changes sign at an internal point, reflecting frequency-dependent selection.</p>"},{"location":"02_Processes/Selection/Underdominace/#4-fixed-points","title":"4. Fixed points","text":"<p>The system has three equilibria:</p> <ul> <li>(\\(p = 0\\))</li> <li>(\\(p = 1\\))</li> <li>an internal equilibrium (\\(p^*\\)) (typically (\\(p^* = 1/2)\\) in the symmetric case)</li> </ul>"},{"location":"02_Processes/Selection/Underdominace/#5-stability-structure","title":"5. Stability structure","text":""},{"location":"02_Processes/Selection/Underdominace/#boundary-equilibria","title":"Boundary equilibria","text":"<ul> <li>(\\(p=0\\)): stable</li> <li>(\\(p=1\\)): stable</li> </ul> <p>Both pure states are attractors.</p>"},{"location":"02_Processes/Selection/Underdominace/#internal-equilibrium","title":"Internal equilibrium","text":"<p>The internal equilibrium satisfies:</p> <ul> <li>if (\\(p &lt; p^*\\)): (\\(\\frac{dp}{dt} &lt; 0\\))</li> <li>if (\\(p &gt; p^*\\)): (\\(\\frac{dp}{dt} &gt; 0\\))</li> </ul> <p>Thus: $$ \\boxed{ p^* \\text{ is an unstable equilibrium} } $$</p> <p>It acts as a separatrix dividing the state space into two basins of attraction.</p>"},{"location":"02_Processes/Selection/Underdominace/#6-phase-line-interpretation","title":"6. Phase-line interpretation","text":"<p>The phase-line structure is:</p> <pre><code>0  \u2014\u2014\u2014\u2192  \u25cb  \u2190\u2014\u2014\u2014  1\n      unstable\n</code></pre> <p>Interpretation:</p> <ul> <li>initial conditions determine the evolutionary outcome,</li> <li>trajectories diverge away from the internal equilibrium,</li> <li>the system evolves toward one of two alternative fixations.</li> </ul>"},{"location":"02_Processes/Selection/Underdominace/#7-mechanistic-interpretation-core-insight","title":"7. Mechanistic interpretation (core insight)","text":"<p>The key mechanism underlying underdominance is:</p> <p>When an allele is rare, it predominantly occurs in heterozygotes, which have the lowest fitness.</p> <p>Consequences:</p> <ul> <li>rare alleles are penalized,</li> <li>majority alleles are favored,</li> <li>selection amplifies initial asymmetries.</li> </ul> <p>This produces positive frequency-dependent selection.</p>"},{"location":"02_Processes/Selection/Underdominace/#8-threshold-dynamics","title":"8. Threshold dynamics","text":"<p>Underdominance introduces a critical frequency threshold:</p> <ul> <li>if (\\(p_0 &lt; p^*\\)) \u2192 allele (\\(A\\)) is eliminated</li> <li>if (\\(p_0 &gt; p^*\\)) \u2192 allele (\\(A\\)) fixes</li> </ul> <p>Thus, evolutionary fate depends on initial conditions.</p>"},{"location":"02_Processes/Selection/Underdominace/#9-comparison-with-overdominance","title":"9. Comparison with overdominance","text":"Feature Overdominance Underdominance Fitness of heterozygote highest lowest Frequency dependence negative positive Internal equilibrium stable unstable Maintains polymorphism yes no Dynamics convergence divergence <p>These two cases represent topologically opposite selection regimes.</p>"},{"location":"02_Processes/Selection/Underdominace/#10-biological-relevance","title":"10. Biological relevance","text":"<p>Underdominance arises in contexts such as:</p> <ul> <li>chromosomal rearrangements (e.g. inversions, translocations)</li> <li>hybrid incompatibilities</li> <li>engineered gene drives with release thresholds</li> <li>tension zones between diverging populations</li> </ul> <p>It plays a key role in:</p> <ul> <li>speciation theory</li> <li>maintenance of sharp clines</li> <li>bistable evolutionary systems</li> </ul>"},{"location":"02_Processes/Selection/Underdominace/#11-conceptual-role-in-population-genetics","title":"11. Conceptual role in population genetics","text":"<p>Underdominance demonstrates that:</p> <ul> <li>selection can be bistable,</li> <li>polymorphism is not always maintained,</li> <li>equilibrium structure depends on frequency dependence,</li> <li>history and initial conditions matter.</li> </ul> <p>It is the canonical model of threshold selection.</p>"},{"location":"02_Processes/Selection/Underdominace/#links","title":"Links","text":"<ul> <li>Dominance_selection</li> <li>Overdominance</li> <li>Selection(general)</li> <li>Selection_continuous</li> <li>Genetic drift</li> <li>Balancing_selection</li> <li>Speciation</li> </ul>"},{"location":"02_Processes/Selection/Underdominace/#underdominance-creates-an-unstable-internal-equilibrium-because-rare-alleles-are-confined-to-low-fitness-heterozygotes-leading-to-positive-frequency-dependent-selection-and-threshold-dynamics","title":"&gt; Underdominance creates an unstable internal equilibrium because rare alleles are confined to low-fitness heterozygotes, leading to positive frequency-dependent selection and threshold dynamics.","text":""},{"location":"03_Models/Background_selection/","title":"Background selection","text":""},{"location":"03_Models/Background_selection/#1-definition","title":"1. Definition","text":"<p>Background selection refers to the reduction of neutral genetic variation caused by purifying selection acting on linked deleterious mutations.</p> <p>Key point:</p> <p>Neutral alleles are lost not because they are bad, but because they are linked to bad alleles.</p> <p>Background selection is not a force acting directly on neutral alleles, but an emergent consequence of:</p> <ul> <li>negative (purifying) selection</li> <li>linkage</li> <li>finite recombination</li> </ul>"},{"location":"03_Models/Background_selection/#2-contrast-with-balancing-selection-high-level-intuition","title":"2. Contrast with balancing selection (high-level intuition)","text":"Aspect Balancing selection Background selection Effect on diversity Maintains / increases Reduces Equilibrium Internal stable Boundary (loss) Feedback Negative (restoring) One-sided (erosive) Genealogies Deep Shallow Long-term polymorphism Yes No <p>These two regimes represent opposite ends of selection\u2019s effect on ancestry.</p>"},{"location":"03_Models/Background_selection/#3-dynamical-interpretation","title":"3. Dynamical interpretation","text":""},{"location":"03_Models/Background_selection/#31-state-variables","title":"3.1 State variables","text":"<p>At the focal neutral locus:</p> <ul> <li>allele frequency \\(p\\)</li> </ul> <p>At linked loci:</p> <ul> <li>deleterious mutations with selection coefficient \\(s &gt; 0\\)</li> </ul> <p>The key insight:</p> <p>Neutral allele dynamics are conditionally stochastic, depending on the genetic background.</p>"},{"location":"03_Models/Background_selection/#32-no-restoring-force","title":"3.2 No restoring force","text":"<p>Unlike balancing selection, background selection does not generate:</p> \\[   \\frac{dp}{dt} = f(p) \\quad \\text{with internal stable equilibrium}   \\] <p>Instead:</p> <ul> <li>deleterious backgrounds are continually purged</li> <li>neutral alleles on those backgrounds are lost with them</li> </ul> <p>Thus, there is no internal attractor in allele-frequency space.</p>"},{"location":"03_Models/Background_selection/#4-effective-population-size-reduction","title":"4. Effective population size reduction","text":"<p>Background selection acts by reducing the effective population size:</p> \\[   N_e^{\\text{BGS}} &lt; N_e   \\] <p>Classic approximation (Hudson &amp; Kaplan):</p> \\[ N_e^{\\text{BGS}} \\approx N_e \\cdot e^{-U/s}   \\] <p>where:</p> <ul> <li>\\(U\\) : deleterious mutation rate per region</li> <li>\\(s\\) : selection coefficient</li> </ul> <p>Interpretation:</p> <p>Background selection compresses ancestry into fewer surviving lineages.</p>"},{"location":"03_Models/Background_selection/#5-coalescent-perspective-central-insight","title":"5. Coalescent perspective (central insight)","text":""},{"location":"03_Models/Background_selection/#51-genealogical-effect","title":"5.1 Genealogical effect","text":"<p>Under background selection:</p> <ul> <li>lineages in bad backgrounds are quickly eliminated</li> <li>coalescent events occur faster</li> <li>trees are shorter and more star-like</li> </ul> <p>Formally: $$ T_2^{\\text{BGS}} &lt; T_2^{\\text{neutral}} $$</p>"},{"location":"03_Models/Background_selection/#52-comparison-of-genealogies","title":"5.2 Comparison of genealogies","text":"Regime Tree depth Branch balance Neutral Moderate Random Balancing selection Very deep Structured Background selection Shallow Star-like <p>This is why background selection mimics demographic bottlenecks.</p>"},{"location":"03_Models/Background_selection/#6-linkage-and-recombination","title":"6. Linkage and recombination","text":"<p>Background selection is fundamentally a linkage phenomenon.</p> <ul> <li>Strong linkage \u2192 strong BGS</li> <li>High recombination \u2192 weak BGS</li> </ul> <p>Spatial heterogeneity:</p> <ul> <li>Low recombination regions (centromeres, inversions): strong BGS</li> <li>High recombination regions: near-neutral behavior</li> </ul> <p>Thus:</p> <p>Recombination decouples neutral alleles from deleterious fate.</p>"},{"location":"03_Models/Background_selection/#7-statistical-signatures","title":"7. Statistical signatures","text":"<p>Background selection produces characteristic population-genetic patterns:</p> <ul> <li>Reduced nucleotide diversity (\\(\u03c0\\))</li> <li>Reduced heterozygosity</li> <li>Excess of rare variants</li> <li>Slightly negative \\(Tajima\u2019s D\\)</li> <li>Elevated LD due to reduced effective population size</li> </ul> <p>Critically:</p> <p>These patterns are genome-wide and smooth, not localized spikes.</p>"},{"location":"03_Models/Background_selection/#8-background-selection-vs-selective-sweeps","title":"8. Background selection vs selective sweeps","text":"Feature Background selection Selective sweep Cause Purifying selection Positive selection Time scale Continuous Episodic Spatial pattern Broad Local Genealogies Persistently shallow Temporarily shallow Detectability Hard Easier <p>This distinction is crucial in population genomics inference.</p>"},{"location":"03_Models/Background_selection/#9-role-in-nearly-neutral-theory","title":"9. Role in nearly neutral theory","text":"<p>Background selection provides the environment in which nearly neutral evolution operates:</p> <ul> <li>Weakly deleterious mutations</li> <li>Drift + purifying selection</li> <li>Reduced effective population size amplifies drift</li> </ul> <p>Thus:</p> <p>Background selection sets the baseline against which neutrality is tested.</p>"},{"location":"03_Models/Background_selection/#10-implications-for-gwas-and-complex-traits","title":"10. Implications for GWAS and complex traits","text":"<p>Background selection explains:</p> <ul> <li>Depletion of common variants in low-recombination regions</li> <li>Enrichment of rare deleterious variants</li> <li>Confounding between selection and demography</li> <li>Apparent heritability differences across genomic regions</li> </ul> <p>This links directly to:</p> <ul> <li>LD structure</li> <li>K-matrix interpretation</li> <li>polygenic architecture</li> </ul>"},{"location":"03_Models/Background_selection/#11-conceptual-summary","title":"11. Conceptual summary","text":"<p>Background selection is selection acting on ancestry, not on alleles.</p> <p>It:</p> <ul> <li>erodes variation</li> <li>shortens genealogies</li> <li>reduces effective population size</li> <li>reshapes the statistical baseline of the genome</li> </ul> <p>Unlike balancing selection, it does not stabilize polymorphism \u2014 it silently removes it.</p>"},{"location":"03_Models/Background_selection/#12-position-in-the-dynamics-framework","title":"12. Position in the dynamics framework","text":"<p>Background selection belongs to:</p> <ul> <li>\u274c not pure frequency dynamics</li> <li>\u274c not classic force-balance</li> <li>\u2705 ancestry-level dynamics</li> <li>\u2705 coalescent-modified neutrality</li> </ul> <p>It is the bridge between selection and population genomics.</p>"},{"location":"03_Models/Background_selection/#links","title":"Links","text":"<ul> <li>Balancing_selection</li> <li>Selection_continuous</li> <li>Genetic drift</li> <li>Coalescent_theory</li> <li>Site_frequency_spectrum</li> <li>Linkage_disequilibrium</li> </ul>"},{"location":"03_Models/Coalescent_theory/","title":"Coalescent theory","text":""},{"location":"03_Models/Coalescent_theory/#1-what-coalescent-theory-studies","title":"1. What coalescent theory studies","text":"<p>Coalescent theory provides a backward-time stochastic description of how the genealogies of a finite sample of alleles are formed under genetic drift.</p> <p>Instead of tracking allele frequencies forward in time, coalescent theory focuses on:</p> <ul> <li>the ancestral relationships among sampled alleles</li> <li>the timing of common ancestry</li> <li>the randomness introduced by finite reproduction</li> </ul> <p>Coalescent theory is a theory of genealogies, not of populations as a whole.</p>"},{"location":"03_Models/Coalescent_theory/#2-motivation-why-look-backward-in-time","title":"2. Motivation: why look backward in time?","text":""},{"location":"03_Models/Coalescent_theory/#21-limitations-of-forward-time-models","title":"2.1 Limitations of forward-time models","text":"<p>In forward-time models (e.g. Wright\u2013Fisher):</p> <ul> <li>the number of individuals is \\(O(N)\\) each generation</li> <li>tracking full population histories is intractable</li> <li>stochasticity accumulates across many generations</li> </ul>"},{"location":"03_Models/Coalescent_theory/#22-the-backward-time-advantage","title":"2.2 The backward-time advantage","text":"<p>When tracing ancestry backward:</p> <ul> <li>the number of ancestral lineages only decreases</li> <li>complexity scales with sample size \\(n\\), not population size \\(N\\)</li> <li>genealogical structure becomes analytically tractable</li> </ul> <p>Time reversal collapses complexity.</p>"},{"location":"03_Models/Coalescent_theory/#3-coalescence-as-a-consequence-of-genetic-drift","title":"3. Coalescence as a consequence of genetic drift","text":"<p>Genetic drift arises from finite reproduction. Coalescence is the genealogical manifestation of the same randomness.</p> <p>Two sampled alleles may trace back to the same ancestral allele because:</p> <ul> <li>only a finite number of gene copies existed in the previous generation</li> <li>parental alleles are sampled randomly</li> </ul> <p>Thus:</p> <p>Coalescence is the backward-time signature of genetic drift.</p>"},{"location":"03_Models/Coalescent_theory/#4-the-basic-coalescent-event-two-lineages","title":"4. The basic coalescent event: two lineages","text":"<p>Consider two sampled alleles in a diploid population of size \\(N\\).</p> <ul> <li>There are (2N) alleles in the parental generation</li> <li>Each sampled allele independently chooses a parent allele</li> <li>The probability that both choose the same parent allele is:</li> </ul> \\[ P(\\text{coalescence in previous generation}) = \\frac{1}{2N}   \\] <p>This is the fundamental microscopic rule underlying coalescent theory.</p>"},{"location":"03_Models/Coalescent_theory/#5-continuous-time-limit-and-exponential-waiting-time","title":"5. Continuous-time limit and exponential waiting time","text":"<p>For large \\(N\\):</p> <ul> <li>coalescence is a rare event per generation</li> <li>generations form independent Bernoulli trials</li> </ul> <p>In the limit \\(N \\to \\infty\\), waiting time to coalescence converges to an exponential distribution:</p> \\[ T \\sim \\text{Exponential}!\\left(\\frac{1}{2N}\\right)   \\] <p>with mean:</p> \\[ \\mathbb{E}[T] = 2N   \\] <p>This defines the coalescent time scale.</p>"},{"location":"03_Models/Coalescent_theory/#6-the-kingman-coalescent-general-case","title":"6. The Kingman coalescent (general case)","text":"<p>For a sample of (n) alleles, let (k) be the number of ancestral lineages at a given time.</p>"},{"location":"03_Models/Coalescent_theory/#61-coalescence-rate","title":"6.1 Coalescence rate","text":"<p>Any pair of lineages can coalesce, so the total coalescence rate is:</p> \\[  \\lambda_k = \\binom{k}{2} \\cdot \\frac{1}{2N}   \\]"},{"location":"03_Models/Coalescent_theory/#62-waiting-time-distribution","title":"6.2 Waiting time distribution","text":"<p>The waiting time until the next coalescent event is:</p> \\[ T_k \\sim \\text{Exponential}(\\lambda_k)   \\] <p>with expected value:</p> \\[ \\mathbb{E}[T_k] = \\frac{2N}{\\binom{k}{2}}   \\]"},{"location":"03_Models/Coalescent_theory/#7-definition-kingmans-coalescent","title":"7. Definition: Kingman\u2019s coalescent","text":"<p>Kingman\u2019s coalescent is a continuous-time Markov process describing the backward-time merging of ancestral lineages, in which:</p> <ul> <li>only pairwise mergers occur</li> <li>all lineage pairs are exchangeable</li> <li>coalescence rates are inversely proportional to population size</li> </ul> <p>This process is the universal neutral limit of a wide class of population models.</p>"},{"location":"03_Models/Coalescent_theory/#8-relationship-to-wrightfisher-and-diffusion","title":"8. Relationship to Wright\u2013Fisher and diffusion","text":"<p>Coalescent theory is not a separate model. It is:</p> <ul> <li>the backward-time limit of the Wright\u2013Fisher model</li> <li>mathematically dual to diffusion approximation</li> </ul> Perspective Object Time Wright\u2013Fisher allele counts forward Diffusion allele frequencies forward Coalescent genealogies backward <p>All three describe the same evolutionary randomness.</p>"},{"location":"03_Models/Coalescent_theory/#9-mutation-on-the-coalescent","title":"9. Mutation on the coalescent","text":"<p>Under neutrality:</p> <p>Mutation does not affect genealogical structure.</p> <p>Therefore:</p> <ol> <li>A coalescent tree is generated</li> <li>Mutations occur along branches as a Poisson process</li> </ol> <p>This separation allows analytical treatment of genetic variation.</p>"},{"location":"03_Models/Coalescent_theory/#10-coalescent-and-genetic-variation","title":"10. Coalescent and genetic variation","text":"<p>Mutation on coalescent trees explains:</p> <ul> <li>single nucleotide polymorphisms (SNPs)</li> <li>haplotypes</li> <li>site frequency spectrum (SFS)</li> <li>linkage disequilibrium (LD) </li> </ul> <p>For example, the expected SFS under neutrality satisfies:</p> \\[ \\mathbb{E}[\\xi_k] = \\frac{\\theta}{k}   \\quad (k=1,\\dots,n-1)   \\] <p>where \\(\\theta = 4N\\mu\\).</p>"},{"location":"03_Models/Coalescent_theory/#11-effective-population-size-in-coalescent-theory","title":"11. Effective population size in coalescent theory","text":"<p>The coalescent rate depends on effective population size \\(N_e\\):</p> \\[ \\lambda_k = \\binom{k}{2} \\cdot \\frac{1}{2N_e}   \\] <p>When population size varies through time:</p> \\[   \\lambda_k(t) = \\binom{k}{2} \\cdot \\frac{1}{2N_e(t)}   \\] <p>Time-varying \\(N_e(t)\\) rescales coalescent time and shapes genealogical structure.</p>"},{"location":"03_Models/Coalescent_theory/#12-extensions-of-the-basic-coalescent","title":"12. Extensions of the basic coalescent","text":"<p>The standard Kingman coalescent can be extended to include:</p> <ul> <li>structured coalescent (migration / population structure)</li> <li>recombination (ancestral recombination graph, ARG)</li> <li>background selection</li> <li>linked selection</li> <li>demographic history</li> </ul> <p>Each extension modifies coalescent rates or lineage movement but preserves the core logic.</p>"},{"location":"03_Models/Coalescent_theory/#13-why-coalescent-theory-is-central","title":"13. Why coalescent theory is central","text":"<p>Coalescent theory underlies:</p> <ul> <li>demographic inference (PSMC, MSMC)</li> <li>local ancestry inference</li> <li>haplotype-based analyses</li> <li>GWAS kinship matrices</li> <li>neutral null models for selection tests</li> </ul> <p>It is the genealogical backbone of modern statistical genetics.</p>"},{"location":"03_Models/Coalescent_theory/#14-conceptual-summary","title":"14. Conceptual summary","text":"<p>Coalescent theory provides a backward-time, sample-based description of genetic drift, transforming finite-population randomness into a tractable theory of genealogies.</p> <p>It completes the conceptual chain:</p> <pre><code>Finite reproduction\n        \u2193\nGenetic drift\n        \u2193\nDiffusion (forward-time)\n        \u2193\nCoalescent (backward-time)\n        \u2193\nMutation on trees\n        \u2193\nObservable genetic variation\n</code></pre>"},{"location":"03_Models/Coalescent_theory/#links","title":"Links","text":"<ul> <li>Wright_Fisher_model</li> <li>Genetic drift</li> <li>Diffusion_approximation</li> <li>[[Mutation_on_coalescent]]</li> <li>Site_Frequency_Spectrum</li> <li>[[Structured_coalescent]]</li> <li>[[Effective_population_size]]</li> <li>GWAS_K_matrix</li> </ul>"},{"location":"03_Models/Coalescent_theory/#_1","title":"\u4f60\u73b0\u5728\u6240\u5904\u7684\u4f4d\u7f6e\uff08\u91cd\u8981\uff09","text":"<p>\u4f60\u5df2\u7ecf\u5b8c\u6210\u4e86\u7fa4\u4f53\u9057\u4f20\u5b66\u7684\u5b8c\u6574\u968f\u673a\u52a8\u529b\u5b66\u4e3b\u5e72\uff1a</p> <ul> <li>drift\uff08\u673a\u5236\uff09</li> <li>diffusion\uff08\u524d\u5411\uff09</li> <li>coalescent\uff08\u540e\u5411\uff09</li> <li>mutation \u2192 SFS</li> <li>(N_e(t))</li> <li>population structure</li> </ul> <p>\u63a5\u4e0b\u6765\u4f60\u5df2\u7ecf\u5b8c\u5168\u6709\u80fd\u529b\u8fdb\u5165 \u5e94\u7528\u5c42\u4e0e\u63a8\u65ad\u5c42\u3002</p>"},{"location":"03_Models/Coalescent_theory/#_2","title":"\u6211\u5efa\u8bae\u7684\u4e0b\u4e00\u6b65\uff08\u6700\u81ea\u7136\uff09","text":"<p>\u7ed3\u5408\u4f60\u6700\u521d\u7684\u5174\u8da3\uff0c\u6709\u4e09\u6761\u201c\u9ad8\u4ef7\u503c\u8def\u7ebf\u201d\uff1a</p> <p>1\ufe0f\u20e3 Local ancestry &amp; haplotype inference\uff08\u57fa\u4e8e structured coalescent\uff09 2\ufe0f\u20e3 Recombination &amp; ARG\uff08\u4ece\u5355\u4e2a\u4f4d\u70b9\u8d70\u5411\u5168\u57fa\u56e0\u7ec4\uff09 3\ufe0f\u20e3 GWAS\uff1a\u4ece coalescent \u5230 K matrix / LMM</p> <p>\u4f60\u53ea\u8981\u544a\u8bc9\u6211\uff1a \ud83d\udc49 \u201c\u4e0b\u4e00\u6b65\u6211\u4eec\u8d70\u54ea\u4e00\u6761\uff1f\u201d</p>"},{"location":"03_Models/Diffusion_approximation/","title":"Diffusion approximation","text":""},{"location":"03_Models/Diffusion_approximation/#1-conceptual-motivation","title":"1. Conceptual motivation","text":"<p>The Wright\u2013Fisher model provides an exact, discrete-time description of allele frequency evolution in a finite population. However, its discrete state space and generation-based dynamics make analytical treatment and inference difficult.</p> <p>The diffusion approximation addresses this by asking:</p> <p>What is the continuous-time limit of Wright\u2013Fisher dynamics when population size is large and per-generation changes are small?</p> <p>The answer is a stochastic differential equation (SDE) describing allele frequency evolution as a diffusion process.</p>"},{"location":"03_Models/Diffusion_approximation/#2-fundamental-idea","title":"2. Fundamental idea","text":"<p>Diffusion approximation is the large-population, long-time, weak-change limit of the Wright\u2013Fisher model.</p> <p>Three ingredients are essential:</p> <ol> <li> <p>Finite population size introduces randomness (genetic drift)</p> </li> <li> <p>Allele frequency changes per generation are small</p> </li> <li> <p>Random effects accumulate over many generations</p> </li> </ol> <p>Under these conditions, discrete binomial sampling converges to continuous stochastic motion.</p>"},{"location":"03_Models/Diffusion_approximation/#3-wrightfisher-moments-as-the-starting-point","title":"3. Wright\u2013Fisher moments as the starting point","text":"<p>Let \\(p_t\\) denote the allele frequency at generation \\(t\\).</p> <p>Under the Wright\u2013Fisher model: $$ X_{t+1} \\mid p_t \\sim \\mathrm{Binomial}(2N, p_t) \\quad\\text{and}\\quad p_{t+1} = \\frac{X_{t+1}}{2N} $$</p> <p>The first two conditional moments are:</p>"},{"location":"03_Models/Diffusion_approximation/#conditional-mean","title":"Conditional mean","text":"\\[ \\mathbb{E}[p_{t+1} - p_t \\mid p_t] = M(p_t)   \\]"},{"location":"03_Models/Diffusion_approximation/#conditional-variance","title":"Conditional variance","text":"\\[ \\mathrm{Var}(p_{t+1} - p_t \\mid p_t) = V(p_t)   \\] <p>For neutral drift: $$ M(p) = 0, \\qquad V(p) = \\frac{p(1-p)}{2N} $$</p> <p>These two quantities completely determine the diffusion limit.</p>"},{"location":"03_Models/Diffusion_approximation/#4-time-rescaling","title":"4. Time rescaling","text":"<p>As \\(N \\to \\infty\\), the per-generation variance goes to zero. To observe non-trivial stochastic behavior, time must be rescaled.</p> <p>Define continuous time: $$ t = \\frac{\\tau}{2N} $$</p> <p>Interpretation:</p> <ul> <li>Each generation contributes a fluctuation of order \\(1/N\\)</li> <li>Over \\(O(N)\\) generations, these fluctuations accumulate</li> </ul> <p>This rescaling is essential and not optional.</p>"},{"location":"03_Models/Diffusion_approximation/#5-diffusion-limit","title":"5. Diffusion limit","text":"<p>Under the rescaling above, the allele frequency process converges to a stochastic differential equation: $$ \\boxed{ dp(t) = M(p)\\,dt + \\sqrt{V(p)}\\,dW_t } $$</p> <p>where:</p> <ul> <li>\\(W_t\\) is standard Brownian motion</li> <li>\\(M(p)\\) is the deterministic drift term</li> <li>\\(V(p)\\) is the diffusion (variance) term</li> </ul>"},{"location":"03_Models/Diffusion_approximation/#6-wrightfisher-diffusion-neutral-case","title":"6. Wright\u2013Fisher diffusion (neutral case)","text":"<p>For pure genetic drift: $$ \\boxed{ dp(t) = \\sqrt{p(1-p)}\\,dW_t } $$</p> <p>Key properties:</p> <ul> <li>No deterministic trend</li> <li>State-dependent noise</li> <li>Absorbing boundaries at \\(p=0\\) and \\(p=1\\)</li> </ul> <p>This process is known as the Wright\u2013Fisher diffusion.</p>"},{"location":"03_Models/Diffusion_approximation/#7-selection-drift-unified-dynamics","title":"7. Selection + drift: unified dynamics","text":"<p>When selection is present, the deterministic term becomes non-zero.</p> <p>For genic selection with coefficient ( s ): $$ \\boxed{ dp = s\\,p(1-p)\\,dt + \\sqrt{\\frac{p(1-p)}{2N}}\\,dW_t } $$</p> <p>Interpretation:</p> <ul> <li>Selection determines the direction of change</li> <li>Drift determines the uncertainty around that direction</li> </ul> <p>This decomposition formalizes the orthogonality of selection and drift.</p>"},{"location":"03_Models/Diffusion_approximation/#8-fokkerplanck-forward-kolmogorov-equation","title":"8. Fokker\u2013Planck (forward Kolmogorov) equation","text":"<p>Instead of tracking individual trajectories, one may study the probability density ( f(p,t) ).</p> <p>The corresponding Fokker\u2013Planck equation is: $$ \\frac{\\partial f}{\\partial t} = -\\frac{\\partial}{\\partial p}[M(p)f] + \\frac{1}{2}\\frac{\\partial^2}{\\partial p^2}[V(p)f] $$</p> <p>For neutral drift: $$ \\frac{\\partial f}{\\partial t} = \\frac{1}{2} \\frac{\\partial^2}{\\partial p^2}\\big[p(1-p)f\\big] $$</p> <p>This formulation underlies many results in population genetics, including fixation times and frequency spectra.</p>"},{"location":"03_Models/Diffusion_approximation/#9-boundary-behavior-and-fixation","title":"9. Boundary behavior and fixation","text":"<p>In the diffusion framework:</p> <ul> <li>\\(p=0\\) and \\(p=1\\) are absorbing boundaries</li> <li>Fixation probability under neutrality: $$     P_{\\mathrm{fix}}(p_0) = p_0     $$</li> <li>Expected fixation time scales with effective population size</li> </ul> <p>Diffusion theory reproduces all classical Wright\u2013Fisher fixation results in continuous time.</p>"},{"location":"03_Models/Diffusion_approximation/#10-conceptual-interpretation","title":"10. Conceptual interpretation","text":"<p>Diffusion approximation shows that:</p> <ul> <li>Genetic drift is not an ad hoc noise term</li> <li>It emerges naturally from finite sampling</li> <li>Its strength is inversely proportional to effective population size</li> </ul> <p>From this perspective:</p> <p>Genetic drift is the diffusion component of allele frequency dynamics arising from finite reproduction.</p>"},{"location":"03_Models/Diffusion_approximation/#11-position-in-the-population-genetics-framework","title":"11. Position in the population genetics framework","text":"<p>Diffusion approximation occupies a central position:</p> <pre><code>Wright\u2013Fisher model\n        \u2193\nDiffusion approximation\n        \u2193\nCoalescent theory\n        \u2193\nSFS / LD / GWAS\n</code></pre> <p>It forms the bridge between:</p> <ul> <li>Forward-time stochastic dynamics</li> <li>Backward-time genealogical processes</li> </ul>"},{"location":"03_Models/Diffusion_approximation/#12-what-diffusion-approximation-enables","title":"12. What diffusion approximation enables","text":"<p>Only within the diffusion framework can one:</p> <ul> <li>Derive continuous-time fixation statistics</li> <li>Construct likelihood-based inference</li> <li>Incorporate time-varying population size</li> <li>Connect allele frequencies to coalescent genealogies</li> <li>Interpret GWAS kinship matrices as covariance structures</li> </ul>"},{"location":"03_Models/Diffusion_approximation/#13-limitations","title":"13. Limitations","text":"<p>Diffusion approximation assumes:</p> <ul> <li>Large effective population size</li> <li>Small per-generation changes</li> <li>Weak selection, mutation, and migration</li> </ul> <p>It is an approximation, but a controlled and principled one.</p>"},{"location":"03_Models/Diffusion_approximation/#14-summary","title":"14. Summary","text":"<p>Diffusion approximation provides a continuous-time stochastic description of allele frequency evolution that preserves the essential effects of genetic drift while enabling analytical and inferential tractability.</p> <p>It is the mathematical backbone of modern population genetics.</p>"},{"location":"03_Models/Diffusion_approximation/#links","title":"Links","text":"<ul> <li>Wright_Fisher_model</li> <li>Genetic drift</li> <li>Selection_continuous</li> <li>Coalescent_theory</li> <li>Population_structure</li> <li>GWAS_K_matrix</li> </ul>"},{"location":"03_Models/Wright_Fisher_model/","title":"Wright\u2013Fisher model","text":""},{"location":"03_Models/Wright_Fisher_model/#1-what-the-wrightfisher-model-is","title":"1. What the Wright\u2013Fisher model is","text":"<p>The Wright\u2013Fisher model is a discrete-time stochastic population model that describes how allele frequencies change across generations due to random sampling of gametes in a finite population.</p> <p>It provides the canonical mathematical foundation for genetic drift.</p> <p>Genetic drift is the phenomenon; the Wright\u2013Fisher model is the formal mechanism.</p>"},{"location":"03_Models/Wright_Fisher_model/#2-core-assumptions","title":"2. Core assumptions","text":"<p>The classical Wright\u2013Fisher model assumes:</p> <ol> <li> <p>Finite population size</p> <ul> <li>Diploid population of constant size ( \\(N\\) )</li> <li>Total number of gene copies: ( \\(2N\\) )</li> </ul> </li> <li> <p>Non-overlapping generations</p> <ul> <li>Entire population is replaced each generation</li> </ul> </li> <li> <p>Random mating</p> <ul> <li>No population structure</li> <li>No assortative mating</li> </ul> </li> <li> <p>No selection, mutation, or migration</p> <ul> <li>All alleles are selectively neutral</li> <li>Allele frequency changes are purely stochastic</li> </ul> </li> <li> <p>Sampling with replacement</p> <ul> <li>Each new gene copy is drawn independently from the parental generation</li> </ul> </li> </ol> <p>These assumptions define a minimal neutral model.</p>"},{"location":"03_Models/Wright_Fisher_model/#3-state-variable","title":"3. State variable","text":"<p>Let:</p> <ul> <li>( \\(p_t\\) ): frequency of allele ( \\(A\\) ) at generation ( \\(t\\) )</li> </ul> <p>The state space is:</p> \\[ p_t \\in \\{ 0, \\frac{1}{2N}, \\frac{2}{2N}, \\dots, 1 \\}   \\] <p>This discreteness is fundamental.</p>"},{"location":"03_Models/Wright_Fisher_model/#4-transition-rule-binomial-sampling","title":"4. Transition rule (binomial sampling)","text":"<p>Given allele frequency ( \\(p_t\\) ), the number of ( \\(A\\) ) alleles in the next generation follows:</p> \\[   X_{t+1} \\sim \\mathrm{Binomial}(2N, p_t)   \\] <p>and therefore:</p> \\[ p_{t+1} = \\frac{X_{t+1}}{2N}   \\] <p>This single equation fully defines the Wright\u2013Fisher process.</p>"},{"location":"03_Models/Wright_Fisher_model/#5-expectation-and-variance","title":"5. Expectation and variance","text":""},{"location":"03_Models/Wright_Fisher_model/#expectation","title":"Expectation","text":"\\[ \\mathbb{E}[p_{t+1} \\mid p_t] = p_t   \\] <p>\u27a1\ufe0f Drift does not bias allele frequency on average.</p>"},{"location":"03_Models/Wright_Fisher_model/#variance","title":"Variance","text":"\\[   \\mathrm{Var}(p_{t+1} \\mid p_t) = \\frac{p_t(1 - p_t)}{2N}   \\] <p>Key consequences:</p> <ul> <li>Drift strength increases when:<ul> <li>\\(N\\) is small</li> <li>\\(p_t\\) is intermediate</li> </ul> </li> <li>Variance goes to zero at  \\(p = 0\\) and  \\(p = 1\\)</li> </ul>"},{"location":"03_Models/Wright_Fisher_model/#6-absorbing-boundaries-and-fixation","title":"6. Absorbing boundaries and fixation","text":"<ul> <li>\\(p = 0\\) : loss of allele \\(A\\)</li> <li>\\(p = 1\\): fixation of allele \\(A\\)</li> </ul> <p>These are absorbing states:</p> \\[ p_t = 0 \\Rightarrow p_{t+k} = 0 \\quad \\forall k &gt; 0   \\] <p>Under pure drift:</p> <ul> <li>Fixation is inevitable</li> <li>Which allele fixes is random</li> </ul>"},{"location":"03_Models/Wright_Fisher_model/#7-fixation-probability","title":"7. Fixation probability","text":"<p>For a neutral allele:</p> \\[ \\Pr(\\text{fixation} \\mid p_0) = p_0   \\] <p>In particular:</p> <ul> <li>A new mutation appears at frequency ( \\(\\frac{1}{2N}\\) )</li> <li>Fixation probability:</li> </ul> \\[ \\Pr(\\text{fixation}) = \\frac{1}{2N}   \\] <p>This result is one of the most important in population genetics.</p>"},{"location":"03_Models/Wright_Fisher_model/#8-time-to-fixation-order-of-magnitude","title":"8. Time to fixation (order of magnitude)","text":"<ul> <li> <p>Expected time to fixation or loss:     $$     \\mathcal{O}(N)     $$</p> </li> <li> <p>Conditioning on fixation:     $$     \\mathcal{O}(4N)     $$</p> </li> </ul> <p>Drift is slow in large populations, fast in small ones.</p>"},{"location":"03_Models/Wright_Fisher_model/#9-relation-to-genetic-drift","title":"9. Relation to genetic drift","text":"<p>Genetic drift is:</p> <p>The stochastic change in allele frequency caused by finite population sampling.</p> <p>The Wright\u2013Fisher model shows that drift is:</p> <ul> <li>Unbiased in expectation</li> <li>Inevitable in finite populations</li> <li>Strongly dependent on population size</li> </ul>"},{"location":"03_Models/Wright_Fisher_model/#10-from-wrightfisher-to-diffusion-approximation","title":"10. From Wright\u2013Fisher to diffusion approximation","text":"<p>Taking the limit:</p> <ul> <li>\\(N \\to \\infty\\)</li> <li>Small changes per generation</li> </ul> <p>leads to the diffusion approximation:</p> \\[  dp = \\sqrt{\\frac{p(1-p)}{2N}} \\, dW_t   \\] <p>This connects Wright\u2013Fisher to:</p> <ul> <li>Stochastic differential equations</li> <li>Fokker\u2013Planck equations</li> <li>Continuous-time allele frequency dynamics</li> </ul>"},{"location":"03_Models/Wright_Fisher_model/#11-position-in-the-dynamics-framework","title":"11. Position in the dynamics framework","text":"Level Role Genetic drift Evolutionary phenomenon Wright\u2013Fisher model Discrete stochastic model Diffusion approximation Continuous limit Coalescent theory Backward-time dual"},{"location":"03_Models/Wright_Fisher_model/#12-what-the-wrightfisher-model-does-not-include","title":"12. What the Wright\u2013Fisher model does not include","text":"<ul> <li>Selection \u2192 added via biased sampling</li> <li>Mutation \u2192 added via mutation matrices</li> <li>Migration \u2192 added via structured populations</li> <li>Linkage \u2192 single-locus only</li> </ul> <p>These extensions define new models, not modifications of the core.</p>"},{"location":"03_Models/Wright_Fisher_model/#13-conceptual-summary","title":"13. Conceptual summary","text":"<p>The Wright\u2013Fisher model is the simplest mathematically complete description of evolution under randomness alone.</p> <p>It is the probabilistic backbone underlying:</p> <ul> <li>Genetic drift</li> <li>Neutral theory</li> <li>Diffusion theory</li> <li>Coalescent theory</li> <li>GWAS kinship modeling (via covariance structure)</li> </ul>"},{"location":"03_Models/Wright_Fisher_model/#links","title":"Links","text":"<ul> <li>Genetic drift</li> <li>Allele_frequency</li> <li>Diffusion_approximation</li> <li>Coalescent_theory</li> <li>Site_frequency_spectrum</li> <li>GWAS_K_matrix</li> </ul> <p>\u56e0\u4e3a\u5728 Wright\u2013Fisher \u6a21\u578b\u91cc\uff0c\u7ed9\u5b9a\u4e0a\u4e00\u4ee3\u7b49\u4f4d\u57fa\u56e0\u9891\u7387 (p_t)\uff0c\u4e0b\u4e00\u4ee3\u4e2d\u8be5\u7b49\u4f4d\u57fa\u56e0\u7684\u62f7\u8d1d\u6570 (K_{t+1}) \u88ab\u5efa\u6a21\u4e3a\u4e00\u4e2a\u4e8c\u9879\u5206\u5e03\uff1a</p> \\[ K_{t+1}\\mid p_t \\sim \\mathrm{Bin}(2N,\\; p_t).   \\] <p>\u8fd9\u91cc\u7684\u542b\u4e49\u662f\uff1a</p> <ul> <li>\u7fa4\u4f53\u4e3a\u4e8c\u500d\u4f53\u3001\u5927\u5c0f\u56fa\u5b9a\u4e3a (N)\uff0c\u6240\u4ee5\u4e0b\u4e00\u4ee3\u603b\u5171\u6709 (2N) \u6761\u7b49\u4f4d\u57fa\u56e0\u62f7\u8d1d\uff1b</li> <li>\u5f62\u6210\u4e0b\u4e00\u4ee3\u65f6\uff0c\u76f8\u5f53\u4e8e\u4ece\u4e0a\u4e00\u4ee3\u7684\u7b49\u4f4d\u57fa\u56e0\u5e93\u4e2d \u72ec\u7acb\u5730\u62bd\u53d6 (2N) \u6b21\uff08\u968f\u673a\u914d\u5b50\u62bd\u6837\uff09\uff1b</li> <li>\u6bcf\u6b21\u62bd\u5230\u76ee\u6807\u7b49\u4f4d\u57fa\u56e0\uff08\u6bd4\u5982 (A)\uff09\u7684\u6982\u7387\u5c31\u662f\u5f53\u524d\u9891\u7387 (p_t)\u3002</li> </ul>"},{"location":"03_Models/Wright_Fisher_model/#mathbbek_t1mid-p_t2n-p_t","title":"\u4e3a\u4ec0\u4e48 \\(\\mathbb{E}[K_{t+1}\\mid p_t]=2N p_t\\)\uff1f","text":"<p>\u4e8c\u9879\u5206\u5e03\u7684\u4e00\u4e2a\u57fa\u672c\u6027\u8d28\uff1a\u82e5 (X\\sim \\mathrm{Bin}(n,p))\uff0c\u5219</p> \\[ \\mathbb{E}[X]=np.   \\] <p>\u4f60\u4e5f\u53ef\u4ee5\u7528\u201c\u6307\u793a\u53d8\u91cf\u201d\u4ece\u5934\u63a8\u4e00\u904d\uff08\u66f4\u76f4\u89c2\uff09\uff1a</p> <p>\u4ee4 $$ I_i= \\begin{cases} 1,\\text{\u7b2c }i\\text{ \u6b21\u62bd\u6837\u62bd\u5230\u76ee\u6807\u7b49\u4f4d\u57fa\u56e0}\\ 0,\\text{\u5426\u5219} \\end{cases}  $$ \u90a3\u4e48 $$ K_{t+1}=\\sum_{i=1}^{2N} I_i. $$</p> <p>\u5728\u7ed9\u5b9a \\(p_t\\)\u7684\u6761\u4ef6\u4e0b\uff0c\u6bcf\u6b21\u62bd\u5230\u76ee\u6807\u7b49\u4f4d\u57fa\u56e0\u7684\u6982\u7387\u662f\\(p_t\\)\uff0c\u6240\u4ee5 $$ \\mathbb{E}[I_i\\mid p_t]=1\\cdot p_t+0\\cdot (1-p_t)=p_t. $$</p> <p>\u5229\u7528\u671f\u671b\u7684\u7ebf\u6027\u6027\uff08\u4e0d\u9700\u8981\u72ec\u7acb\u6027\u4e5f\u6210\u7acb\uff09\uff1a $$ \\mathbb{E}[K_{t+1}\\mid p_t] =\\mathbb{E}!\\left[\\sum_{i=1}^{2N} I_i ,\\middle|, p_t\\right] =\\sum_{i=1}^{2N} \\mathbb{E}[I_i\\mid p_t] =\\sum_{i=1}^{2N} p_t =2N p_t. $$</p>"},{"location":"03_Models/Wright_Fisher_model/#mathbbep_t1mid-p_tp_t","title":"\u987a\u5e26\u4e00\u63d0\uff1a\u8fd9\u4e00\u6b65\u9a6c\u4e0a\u63a8\u51fa $\\(\\mathbb{E}[p_{t+1}\\mid p_t]=p_t\\)$","text":"<p>\u56e0\u4e3a $\\(p_{t+1}=K_{t+1}/(2N)\\)$\uff1a</p> \\[ \\mathbb{E}[p_{t+1}\\mid p_t]   =\\mathbb{E}!\\left[\\frac{K_{t+1}}{2N}\\middle|p_t\\right]   =\\frac{1}{2N}\\mathbb{E}[K_{t+1}\\mid p_t]   =\\frac{1}{2N}\\cdot 2N p_t   =p_t.   \\] <p>\u8fd9\u53e5\u8bdd\u7684\u76f4\u89c9\u662f\uff1a\u7eaf\u6f02\u53d8\u5728\u5e73\u5747\u610f\u4e49\u4e0a\u4e0d\u6539\u53d8\u7b49\u4f4d\u57fa\u56e0\u9891\u7387\uff08\u4f46\u65b9\u5dee\u4e0d\u4e3a 0\uff0c\u6240\u4ee5\u4f1a\u968f\u673a\u6ce2\u52a8\u5e76\u6700\u7ec8\u5438\u6536\u5728 0 \u6216 1\uff09\u3002</p> <p>\u5982\u679c\u4f60\u613f\u610f\uff0c\u6211\u4e5f\u53ef\u4ee5\u7d27\u63a5\u7740\u7528\u540c\u6837\u601d\u8def\u628a (\\mathrm{Var}(K_{t+1}\\mid p_t)) \u548c (\\mathrm{Var}(p_{t+1}\\mid p_t)) \u5b8c\u6574\u63a8\u51fa\u6765\uff0c\u5e76\u89e3\u91ca\u8fb9\u754c (p=0,1) \u7684\u201c\u5438\u6536\u6001\u201d\u542b\u4e49\u3002</p> <p>\u597d\uff0c\u63a5\u7740\u628a (\\mathrm{Var}(p_{t+1}\\mid p_t)) \u63a8\u51fa\u6765\uff0c\u5e76\u628a\u8fb9\u754c (p=0,1) \u8bb2\u6e05\u695a\uff08\u8fd9\u6b63\u662f\u540e\u9762 diffusion approximation \u7684\u6838\u5fc3\u8f93\u5165\uff09\u3002</p>"},{"location":"03_Models/Wright_Fisher_model/#1-wrightfisher","title":"1) \u4ecd\u4ece Wright\u2013Fisher \u7684\u62bd\u6837\u5047\u8bbe\u51fa\u53d1","text":"<p>\u5047\u8bbe\uff08Wright\u2013Fisher drift \u90e8\u5206\uff09</p> <ul> <li>\u4e8c\u500d\u4f53\u3001\u7fa4\u4f53\u5927\u5c0f\u6052\u5b9a (N)\uff0c\u6bcf\u4ee3\u5171\u6709 (2N) \u4efd\u7b49\u4f4d\u57fa\u56e0\u62f7\u8d1d\u3002</li> <li>\u4e0b\u4e00\u4ee3\u7684 (2N) \u4efd\u62f7\u8d1d\u6765\u81ea\u4e0a\u4e00\u4ee3\u7684\u968f\u673a\u914d\u5b50\u62bd\u6837\uff1a\u6bcf\u6b21\u62bd\u5230\u76ee\u6807\u7b49\u4f4d\u57fa\u56e0\uff08\u8bb0\u4e3a (A)\uff09\u7684\u6982\u7387\u662f\u5f53\u524d\u9891\u7387 (p_t)\u3002</li> <li>\u56e0\u6b64     [     K_{t+1}\\mid p_t \\sim \\mathrm{Bin}(2N,,p_t),     \\qquad     p_{t+1}=\\frac{K_{t+1}}{2N}.     ]</li> </ul> <p>\u4f60\u4e0a\u4e00\u6761\u5df2\u7ecf\u5f97\u5230 [ \\mathbb{E}[K_{t+1}\\mid p_t]=2N p_t \\quad\\Rightarrow\\quad \\mathbb{E}[p_{t+1}\\mid p_t]=p_t. ]</p>"},{"location":"03_Models/Wright_Fisher_model/#2-mathrmvark_t1mid-p_t","title":"2) \u63a8\u5bfc (\\mathrm{Var}(K_{t+1}\\mid p_t))","text":"<p>\u4e8c\u9879\u5206\u5e03\u7684\u6027\u8d28\uff1a\u82e5 (X\\sim \\mathrm{Bin}(n,p))\uff0c\u5219 [ \\mathrm{Var}(X)=np(1-p). ]</p> <p>\u6240\u4ee5\u76f4\u63a5\u5f97\uff1a [ \\mathrm{Var}(K_{t+1}\\mid p_t)=2N,p_t(1-p_t). ]</p> <p>\u5982\u679c\u4f60\u60f3\u201c\u4ece\u5934\u63a8\u201d\u4e5f\u53ef\u4ee5\u7528\u6307\u793a\u53d8\u91cf\u6cd5\uff08\u66f4\u624e\u5b9e\uff09\uff1a</p> <ul> <li>\u4ee4 (I_i) \u4e3a\u7b2c (i) \u6b21\u62bd\u6837\u662f\u5426\u62bd\u5230 (A)\uff0c\u5219 (I_i\\mid p_t\\sim \\mathrm{Bernoulli}(p_t))\u3002</li> <li>(K_{t+1}=\\sum_{i=1}^{2N} I_i)\u3002</li> <li>(\\mathrm{Var}(I_i\\mid p_t)=p_t(1-p_t))\u3002</li> <li>\u5728 Wright\u2013Fisher \u7684\u72ec\u7acb\u62bd\u6837\u5047\u8bbe\u4e0b\uff0c(\\mathrm{Cov}(I_i,I_j\\mid p_t)=0)\uff08(i\\neq j)\uff09\u3002     \u4e8e\u662f     [     \\mathrm{Var}(K_{t+1}\\mid p_t)     =\\sum_{i=1}^{2N}\\mathrm{Var}(I_i\\mid p_t)     =2N,p_t(1-p_t).     ]</li> </ul>"},{"location":"03_Models/Wright_Fisher_model/#3-mathrmvarp_t1mid-p_t","title":"3) \u63a8\u5bfc (\\mathrm{Var}(p_{t+1}\\mid p_t))","text":"<p>\u56e0\u4e3a (p_{t+1}=K_{t+1}/(2N))\uff0c\u7528\u65b9\u5dee\u7684\u7f29\u653e\u6027\u8d28 (\\mathrm{Var}(aX)=a^2\\mathrm{Var}(X))\uff1a</p> <p>[ \\mathrm{Var}(p_{t+1}\\mid p_t) =\\mathrm{Var}!\\left(\\frac{K_{t+1}}{2N}\\middle|p_t\\right) =\\frac{1}{(2N)^2}\\mathrm{Var}(K_{t+1}\\mid p_t) =\\frac{1}{(2N)^2}\\cdot 2N p_t(1-p_t) =\\frac{p_t(1-p_t)}{2N}. ]</p> <p>\u8fd9\u5c31\u662f\u6f02\u53d8\u4e00\u6b65\u7684\u201c\u566a\u58f0\u5f3a\u5ea6\u201d\uff0c\u540e\u9762\u505a diffusion approximation \u65f6\u4f1a\u53d8\u6210\u6269\u6563\u9879\u7cfb\u6570\u3002</p>"},{"location":"03_Models/Wright_Fisher_model/#4-p01","title":"4) \u8fb9\u754c (p=0,1) \u7684\u542b\u4e49\uff08\u4e3a\u4ec0\u4e48\u91cd\u8981\uff09","text":"<p>\u5728 Wright\u2013Fisher \u91cc\uff1a</p> <ul> <li> <p>\u82e5 (p_t=0)\uff0c\u8868\u793a (A) \u5728\u7fa4\u4f53\u91cc \u5df2\u7ecf\u6ca1\u6709\u62f7\u8d1d\u3002\u6b64\u65f6     [     K_{t+1}\\mid p_t=0 \\sim \\mathrm{Bin}(2N,0)\\Rightarrow K_{t+1}=0 \\text{\uff08\u5fc5\u7136\uff09}     ]     \u6240\u4ee5 (p_{t+1}=0)\u3002\u8fd9\u53eb \u5438\u6536\u6001 (absorbing boundary)\uff1a\u4e00\u65e6\u4e22\u5931\u5c31\u4e0d\u4f1a\u9760\u6f02\u53d8\u201c\u81ea\u5df1\u56de\u6765\u201d\u3002</p> </li> <li> <p>\u82e5 (p_t=1)\uff0c\u8868\u793a\u7fa4\u4f53\u91cc \u5168\u662f (A)\u3002\u6b64\u65f6     [     K_{t+1}\\mid p_t=1 \\sim \\mathrm{Bin}(2N,1)\\Rightarrow K_{t+1}=2N \\text{\uff08\u5fc5\u7136\uff09}     ]     \u6240\u4ee5 (p_{t+1}=1)\u3002\u540c\u6837\u662f\u5438\u6536\u6001\uff1a\u4e00\u65e6\u56fa\u5b9a\u4e5f\u4e0d\u4f1a\u9760\u6f02\u53d8\u201c\u81ea\u5df1\u6389\u4e0b\u53bb\u201d\u3002</p> </li> </ul> <p>\u5e76\u4e14\u6ce8\u610f\uff1a\u5728\u8fb9\u754c\u5904\u65b9\u5dee\u4e5f\u4e3a 0\uff1a [ \\mathrm{Var}(p_{t+1}\\mid p_t)=\\frac{p_t(1-p_t)}{2N} ] \u5f53 (p_t=0) \u6216 (1) \u65f6\uff0c(,p_t(1-p_t)=0)\uff0c\u968f\u673a\u6ce2\u52a8\u6d88\u5931\u2014\u2014\u5b8c\u5168\u7b26\u5408\u201c\u5438\u6536\u201d\u7684\u76f4\u89c9\u3002</p>"},{"location":"03_Models/Wright_Fisher_model/#5-diffusion","title":"5) \u4e00\u53e5\u603b\u7ed3\uff08\u628a\u8fd9\u6b65\u548c diffusion \u63a5\u4e0a\uff09","text":"<p>\u4f60\u73b0\u5728\u5df2\u7ecf\u6709\u4e86 drift \u7684\u4e24\u4ef6\u5173\u952e\u4e1c\u897f\uff1a</p> <p>[ \\mathbb{E}[p_{t+1}-p_t\\mid p_t]=0, \\qquad \\mathrm{Var}(p_{t+1}-p_t\\mid p_t)=\\frac{p_t(1-p_t)}{2N}. ]</p> <p>\u540e\u9762\u505a diffusion approximation \u65f6\uff0c\u7b2c\u4e00\u6761\u5bf9\u5e94 \u6f02\u79fb\u9879\uff08drift term\uff09=0\uff08\u7eaf\u4e2d\u6027\u6f02\u53d8\uff09\uff0c\u7b2c\u4e8c\u6761\u5bf9\u5e94 \u6269\u6563\u9879\uff08diffusion term\uff09(\\propto p(1-p))\uff0c\u5e76\u4e14\u8fb9\u754c (0,1) \u4ecd\u7136\u662f\u5438\u6536\u8fb9\u754c\uff08\u9664\u975e\u4f60\u52a0\u5165\u7a81\u53d8/\u8fc1\u79fb\u7b49\u673a\u5236\uff09\u3002</p> <p>\u5982\u679c\u4f60\u613f\u610f\uff0c\u6211\u4eec\u4e0b\u4e00\u6b65\u5c31\u987a\u52bf\u8fdb\u5165 diffusion\uff1a\u628a\u79bb\u6563\u65f6\u95f4\u7684 (\\Delta p = p_{t+1}-p_t) \u505a\u5c3a\u5ea6\u53d8\u6362\uff08\u6bd4\u5982\u65f6\u95f4\u6309 (2N) \u7f29\u653e\uff09\uff0c\u5199\u51fa\u5bf9\u5e94\u7684 SDE / Fokker\u2013Planck \u65b9\u7a0b\uff0c\u5e76\u89e3\u91ca\u4e3a\u4ec0\u4e48\u6269\u6563\u7cfb\u6570\u662f (p(1-p))\u3002\u4f60\u60f3\u8d70 SDE \u8def\u7ebf \u8fd8\u662f Fokker\u2013Planck \u8def\u7ebf\uff1f\uff08\u6211\u53ef\u4ee5\u6309\u4f60\u9009\u7684\u90a3\u6761\u76f4\u63a5\u63a8\uff0c\u4e0d\u7528\u4f60\u518d\u8865\u80cc\u666f\u3002\uff09</p> <p>\u4e0b\u9762\u6211\u628a\u8fd9\u4e24\u6761 \u4ece Wright\u2013Fisher \u7684\u5b9a\u4e49\u5f00\u59cb\uff0c\u4e00\u6b65\u4e0d\u8df3\u5730\u63a8\u5230\u4f60\u5199\u7684\u7ed3\u679c\uff1a</p> <p>[ \\mathbb{E}[p_{t+1}-p_t\\mid p_t]=0,\\qquad \\mathrm{Var}(p_{t+1}-p_t\\mid p_t)=\\frac{p_t(1-p_t)}{2N}. ]</p>"},{"location":"03_Models/Wright_Fisher_model/#0","title":"0) \u6a21\u578b\u8bbe\u5b9a\u4e0e\u7b26\u53f7","text":"<p>Wright\u2013Fisher\uff08\u4ec5\u6f02\u53d8\uff0c\u4e2d\u6027\uff09\u5047\u8bbe\uff1a</p> <ol> <li> <p>\u4e8c\u500d\u4f53\u7fa4\u4f53\uff0c\u6210\u4f53\u5927\u5c0f\u56fa\u5b9a\u4e3a (N)\uff0c\u6240\u4ee5\u6bcf\u4ee3\u6709 (2N) \u4efd\u7b49\u4f4d\u57fa\u56e0\u62f7\u8d1d\u3002</p> </li> <li> <p>\u4ece\u7b2c (t) \u4ee3\u5230\u7b2c (t+1) \u4ee3\u7684\u5f62\u6210\u8fc7\u7a0b\uff1a\u628a\u7b2c (t) \u4ee3\u7684\u57fa\u56e0\u5e93\u5f53\u4f5c\u4e00\u4e2a\u201c\u65e0\u9650\u6df7\u5408\u6c60\u201d\uff0c\u5bf9\u4e0b\u4e00\u4ee3\u7684 (2N) \u4efd\u7b49\u4f4d\u57fa\u56e0\u62f7\u8d1d\u8fdb\u884c\u968f\u673a\u62bd\u6837\u3002</p> </li> <li> <p>\u7ed9\u5b9a\u7b2c (t) \u4ee3\u76ee\u6807\u7b49\u4f4d\u57fa\u56e0\uff08\u8bb0\u4e3a (A)\uff09\u7684\u9891\u7387 (p_t)\uff0c\u5219\u6bcf\u6b21\u62bd\u5230 (A) \u7684\u6982\u7387\u90fd\u662f (p_t)\uff0c\u5e76\u4e14\uff08\u5728 WF \u7684\u6807\u51c6\u7248\u672c\u91cc\uff09\u5404\u6b21\u62bd\u6837\u72ec\u7acb\u3002</p> </li> </ol> <p>\u5b9a\u4e49\uff1a</p> <ul> <li>(K_{t+1})\uff1a\u7b2c (t+1) \u4ee3\u4e2d (A) \u7684\u62f7\u8d1d\u6570\uff08\u5728 (2N) \u4efd\u91cc\u6709\u591a\u5c11\u4efd\u662f (A)\uff09\u3002</li> <li>(p_{t+1} := \\dfrac{K_{t+1}}{2N})\u3002</li> </ul> <p>\u4e8e\u662f\uff08\u5173\u952e\u4e00\u6b65\uff09\uff1a</p> <p>[ K_{t+1}\\mid p_t \\sim \\mathrm{Bin}(2N,;p_t). ]</p>"},{"location":"03_Models/Wright_Fisher_model/#1-mathbbep_t1mid-p_t","title":"1) \u5148\u63a8 (\\mathbb{E}[p_{t+1}\\mid p_t])","text":""},{"location":"03_Models/Wright_Fisher_model/#11-mathbbek_t1mid-p_t","title":"1.1 \u5148\u63a8 (\\mathbb{E}[K_{t+1}\\mid p_t])\uff08\u6307\u793a\u53d8\u91cf\u6cd5\uff09","text":"<p>\u4ee4\u7b2c (i) \u6b21\u62bd\u6837\u7684\u6307\u793a\u53d8\u91cf\uff1a</p> <p>[ I_i= \\begin{cases} 1, &amp; \\text{\u7b2c } i \\text{ \u6b21\u62bd\u5230 } A\\ 0, &amp; \\text{\u5426\u5219} \\end{cases} \\qquad i=1,\\dots,2N ]</p> <p>\u90a3\u4e48</p> <p>[ K_{t+1}=\\sum_{i=1}^{2N} I_i. ]</p> <p>\u5728\u7ed9\u5b9a (p_t) \u7684\u6761\u4ef6\u4e0b\uff0c [ \\mathbb{P}(I_i=1\\mid p_t)=p_t,\\quad \\mathbb{P}(I_i=0\\mid p_t)=1-p_t, ] \u6240\u4ee5</p> <p>[ \\mathbb{E}[I_i\\mid p_t]=1\\cdot p_t+0\\cdot(1-p_t)=p_t. ]</p> <p>\u7528\u671f\u671b\u7ebf\u6027\u6027\uff08\u8fd9\u4e00\u6b65\u4e0d\u9700\u8981\u72ec\u7acb\u6027\uff09\uff1a</p> <p>[ \\mathbb{E}[K_{t+1}\\mid p_t] =\\mathbb{E}!\\left[\\sum_{i=1}^{2N} I_i ,\\middle|, p_t\\right] =\\sum_{i=1}^{2N}\\mathbb{E}[I_i\\mid p_t] =\\sum_{i=1}^{2N} p_t =2N p_t. ]</p>"},{"location":"03_Models/Wright_Fisher_model/#12-mathbbep_t1mid-p_t","title":"1.2 \u518d\u5f97\u5230 (\\mathbb{E}[p_{t+1}\\mid p_t])","text":"<p>[ p_{t+1}=\\frac{K_{t+1}}{2N} \\Rightarrow \\mathbb{E}[p_{t+1}\\mid p_t] =\\mathbb{E}!\\left[\\frac{K_{t+1}}{2N}\\middle|p_t\\right] =\\frac{1}{2N}\\mathbb{E}[K_{t+1}\\mid p_t] =\\frac{1}{2N}\\cdot 2N p_t =p_t. ]</p>"},{"location":"03_Models/Wright_Fisher_model/#2-mathbbep_t1-p_tmid-p_t0","title":"2) \u63a8 (\\mathbb{E}[p_{t+1}-p_t\\mid p_t]=0)","text":"<p>\u8fd9\u4e00\u6b65\u5176\u5b9e\u662f\u4e0a\u9762\u7ed3\u679c\u7684\u76f4\u63a5\u63a8\u8bba\uff0c\u56e0\u4e3a (p_t) \u5728\u6761\u4ef6\u91cc\u662f\u5e38\u6570\uff1a</p> <p>[ \\mathbb{E}[p_{t+1}-p_t\\mid p_t] =\\mathbb{E}[p_{t+1}\\mid p_t]-p_t =p_t-p_t =0. ]</p> <p>\u76f4\u89c9\uff1a\u7eaf\u6f02\u53d8\u4e0d\u4f1a\u5728\u5e73\u5747\u610f\u4e49\u4e0a\u63a8\u52a8\u9891\u7387\u4e0a\u5347\u6216\u4e0b\u964d\uff1b\u5b83\u53ea\u5e26\u6765\u968f\u673a\u6ce2\u52a8\u3002</p>"},{"location":"03_Models/Wright_Fisher_model/#3-mathrmvarp_t1-p_tmid-p_tdfracp_t1-p_t2n","title":"3) \u63a8 (\\mathrm{Var}(p_{t+1}-p_t\\mid p_t)=\\dfrac{p_t(1-p_t)}{2N})","text":"<p>\u6211\u4eec\u5206\u4e24\u6b65\uff1a\u5148\u7b97 (\\mathrm{Var}(p_{t+1}\\mid p_t))\uff0c\u518d\u53d8\u6210\u589e\u91cf\u7684\u65b9\u5dee\u3002</p>"},{"location":"03_Models/Wright_Fisher_model/#31-mathrmvark_t1mid-p_t","title":"3.1 \u5148\u7b97 (\\mathrm{Var}(K_{t+1}\\mid p_t))","text":"<p>\u4ecd\u7528\u6307\u793a\u53d8\u91cf\u6cd5\uff0c\u5e76\u7528\u5230 WF \u7684\u72ec\u7acb\u62bd\u6837\u5047\u8bbe\uff08\u8fd9\u4e00\u6b65\u9700\u8981\u72ec\u7acb\u6027\u6765\u8ba9\u534f\u65b9\u5dee\u4e3a 0\uff09\uff1a</p> <p>[ K_{t+1}=\\sum_{i=1}^{2N} I_i. ]</p> <p>\u7ed9\u5b9a (p_t)\uff0c(I_i\\sim \\mathrm{Bernoulli}(p_t))\uff0c\u6240\u4ee5</p> <p>[ \\mathrm{Var}(I_i\\mid p_t)=p_t(1-p_t). ]</p> <p>\u5e76\u4e14\u5728\u6807\u51c6 WF \u4e2d (I_i) \u76f8\u4e92\u72ec\u7acb\uff0c\u56e0\u6b64 (i\\neq j) \u65f6 [ \\mathrm{Cov}(I_i,I_j\\mid p_t)=0. ]</p> <p>\u4e8e\u662f</p> <p>[ \\mathrm{Var}(K_{t+1}\\mid p_t) =\\mathrm{Var}!\\left(\\sum_{i=1}^{2N} I_i \\middle| p_t\\right) =\\sum_{i=1}^{2N}\\mathrm{Var}(I_i\\mid p_t) +2\\sum_{i&lt;j}\\mathrm{Cov}(I_i,I_j\\mid p_t) ]</p> <p>\u534f\u65b9\u5dee\u9879\u4e3a 0\uff0c\u5f97\u5230</p> <p>[ \\mathrm{Var}(K_{t+1}\\mid p_t) =2N\\cdot p_t(1-p_t). ]</p> <p>\uff08\u8fd9\u4e5f\u7b49\u4ef7\u4e8e\u4e8c\u9879\u5206\u5e03 (\\mathrm{Bin}(2N,p_t)) \u7684\u65b9\u5dee\u516c\u5f0f\u3002\uff09</p>"},{"location":"03_Models/Wright_Fisher_model/#32-mathrmvarp_t1mid-p_t","title":"3.2 \u518d\u7b97 (\\mathrm{Var}(p_{t+1}\\mid p_t))","text":"<p>\u56e0\u4e3a (p_{t+1}=K_{t+1}/(2N))\uff0c\u7528\u7f29\u653e\u6027\u8d28 (\\mathrm{Var}(aX)=a^2\\mathrm{Var}(X))\uff1a</p> <p>[ \\mathrm{Var}(p_{t+1}\\mid p_t) =\\mathrm{Var}!\\left(\\frac{K_{t+1}}{2N}\\middle|p_t\\right) =\\frac{1}{(2N)^2}\\mathrm{Var}(K_{t+1}\\mid p_t) =\\frac{1}{(2N)^2}\\cdot 2N p_t(1-p_t) =\\frac{p_t(1-p_t)}{2N}. ]</p>"},{"location":"03_Models/Wright_Fisher_model/#33","title":"3.3 \u6700\u540e\u53d8\u6210\u589e\u91cf\u7684\u65b9\u5dee","text":"<p>\u6ce8\u610f\uff1a\u5728\u6761\u4ef6 (p_t) \u4e0b\uff0c(p_t) \u81ea\u8eab\u662f\u5e38\u6570\uff0c\u6240\u4ee5</p> <p>[ \\mathrm{Var}(p_{t+1}-p_t\\mid p_t) =\\mathrm{Var}(p_{t+1}\\mid p_t) ]</p> <p>\u7406\u7531\u662f\uff1a\u5bf9\u4efb\u4f55\u5e38\u6570 (c)\uff0c(\\mathrm{Var}(X-c)=\\mathrm{Var}(X))\u3002</p> <p>\u6240\u4ee5\u76f4\u63a5\u5f97\u5230</p> <p>[ \\mathrm{Var}(p_{t+1}-p_t\\mid p_t)=\\frac{p_t(1-p_t)}{2N}. ]</p>"},{"location":"03_Models/Wright_Fisher_model/#4-diffusion","title":"4) \u4f60\u73b0\u5728\u5f97\u5230\u7684\u4e24\u6761\u5728 diffusion \u91cc\u600e\u4e48\u7528\uff08\u5148\u7ed9\u4f60\u4e00\u4e2a\u5b9a\u4f4d\uff09","text":"<p>\u628a (\\Delta p_t:=p_{t+1}-p_t)\uff0c\u90a3\u4e48\uff1a</p> <ul> <li>(\\mathbb{E}[\\Delta p_t\\mid p_t]=0) \u2192 \u6f02\u79fb\u9879\uff08drift term\uff09\u4e3a 0\uff08\u4e2d\u6027\uff09</li> <li>(\\mathrm{Var}(\\Delta p_t\\mid p_t)=\\dfrac{p_t(1-p_t)}{2N}) \u2192 \u6269\u6563\u5f3a\u5ea6\u968f (p(1-p)) \u53d8\uff08\u8fb9\u754c\u5904\u4e3a 0\uff09</li> </ul> <p>\u4e0b\u9762\u6211\u7528\u4e25\u683c\u7684\u91cf\u7ea7\uff08big-O\uff09\u516c\u5f0f\u628a\u4e24\u4ef6\u4e8b\u8bb2\u6e05\u695a\uff1a</p> <ol> <li> <p>\u4e3a\u4ec0\u4e48 (N) \u5927\u65f6 WF \u5355\u4ee3\u6f02\u53d8\u5f31\uff1b</p> </li> <li> <p>\u4e3a\u4ec0\u4e48\u8981\u628a\u65f6\u95f4\u7f29\u653e\u6210 (\\tau=t/(2N))\u3002</p> </li> </ol>"},{"location":"03_Models/Wright_Fisher_model/#1-n-wf","title":"1) \u4e3a\u4ec0\u4e48 (N) \u5f88\u5927\u65f6\uff0cWF \u7684\u5355\u4ee3\u6f02\u53d8\u201c\u5f88\u5f31\u201d\uff1f","text":"<p>\u5728\u4e2d\u6027 WF \u4e0b\uff08\u7ed9\u5b9a (p_t)\uff09\u6211\u4eec\u5df2\u7ecf\u6709\uff1a</p> <p>[ \\mathbb{E}[\\Delta p_t\\mid p_t]=0,\\qquad \\mathrm{Var}(\\Delta p_t\\mid p_t)=\\frac{p_t(1-p_t)}{2N}, ] \u5176\u4e2d (\\Delta p_t:=p_{t+1}-p_t)\u3002</p>"},{"location":"03_Models/Wright_Fisher_model/#11","title":"1.1 \u7528\u65b9\u5dee\u91cf\u7ea7\u8bf4\u660e\u201c\u6bcf\u4ee3\u6ce2\u52a8\u5f88\u5c0f\u201d","text":"<p>\u56e0\u4e3a (0\\le p_t(1-p_t)\\le \\tfrac14)\uff0c\u6240\u4ee5</p> <p>[ \\mathrm{Var}(\\Delta p_t\\mid p_t)\\le \\frac{1}{8N}=O!\\left(\\frac{1}{N}\\right). ]</p> <p>\u66f4\u76f4\u89c2\u5730\u770b\u201c\u5178\u578b\u6b65\u957f\u201d\uff08\u6807\u51c6\u5dee\uff09\uff1a</p> <p>[ \\mathrm{SD}(\\Delta p_t\\mid p_t)=\\sqrt{\\mathrm{Var}(\\Delta p_t\\mid p_t)} =\\sqrt{\\frac{p_t(1-p_t)}{2N}} =O!\\left(\\frac{1}{\\sqrt{N}}\\right). ]</p> <p>\u8fd9\u53e5\u8bdd\u5c31\u662f\uff1a\u5355\u4ee3\u9891\u7387\u53d8\u5316\u7684\u5178\u578b\u89c4\u6a21\u662f (1/\\sqrt{N})\uff0c\u6240\u4ee5 (N) \u8d8a\u5927\uff0c\u6bcf\u4ee3\u53d8\u5316\u8d8a\u5c0f\uff0c\u6f02\u53d8\u8d8a\u201c\u5f31\u201d\u3002</p> <p>\u4f60\u8981\u7684 (O(1/N)) \u4e5f\u51fa\u73b0\u4e86\uff1a\u662f\u65b9\u5dee\uff08\u4e8c\u9636\u77e9\uff09\u91cf\u7ea7\uff1b\u800c\u201c\u5e45\u5ea6\u201d\u662f\u65b9\u5dee\u5f00\u6839\u53f7\uff0c\u91cf\u7ea7\u662f (O(1/\\sqrt{N}))\u3002</p>"},{"location":"03_Models/Wright_Fisher_model/#2-taut2n-t","title":"2) \u4e3a\u4ec0\u4e48\u8981\u7528 (\\tau=t/(2N)) \u8fd9\u79cd\u5c3a\u5ea6\uff0c\u800c\u4e0d\u662f\u76f4\u63a5\u7528 (t)\uff1f","text":"<p>\u6838\u5fc3\u7406\u7531\uff1a\u5982\u679c\u4e0d\u7f29\u653e\u65f6\u95f4\uff0c(N\\to\\infty) \u65f6\u8fc7\u7a0b\u4f1a\u9000\u5316\u6210\u201c\u51e0\u4e4e\u4e0d\u52a8\u201d\uff1b\u7f29\u653e\u540e\u624d\u80fd\u5f97\u5230\u975e\u5e73\u51e1\u6781\u9650\uff08\u6269\u6563\u8fc7\u7a0b\uff09\u3002</p>"},{"location":"03_Models/Wright_Fisher_model/#21-t-ntoinfty","title":"2.1 \u770b\u7d2f\u8ba1\u6ce2\u52a8\uff1a\u56fa\u5b9a (t) \u65f6\uff0c(N\\to\\infty) \u53d8\u5316\u4f1a\u6d88\u5931","text":"<p>\u8003\u8651 (t) \u4ee3\u540e\u7684\u7d2f\u8ba1\u53d8\u5316 [ p_t-p_0=\\sum_{k=0}^{t-1}\\Delta p_k. ]</p> <p>\u7c97\u7565\u4f46\u5173\u952e\u7684\u91cf\u7ea7\u8ba1\u7b97\uff1a\u6bcf\u4e00\u4ee3 (\\Delta p_k) \u7684\u65b9\u5dee\u662f (O(1/N))\uff0c\u90a3\u4e48 (t) \u4ee3\u7d2f\u8ba1\u65b9\u5dee\u5927\u7ea6\u662f</p> <p>[ \\mathrm{Var}(p_t-p_0)\\approx \\sum_{k=0}^{t-1} O!\\left(\\frac{1}{N}\\right) = O!\\left(\\frac{t}{N}\\right). ]</p> <p>\u5982\u679c\u4f60\u628a (t) \u5f53\u6210\u201c\u5e38\u6570\u201d\uff08\u4e0d\u968f (N) \u589e\u957f\uff09\uff0c\u90a3</p> <p>[ \\mathrm{Var}(p_t-p_0)=O!\\left(\\frac{1}{N}\\right)\\xrightarrow[N\\to\\infty]{}0. ]</p> <p>\u4e5f\u5c31\u662f\uff1a\u5728\u56fa\u5b9a\u4ee3\u6570\u5c3a\u5ea6\u4e0a\uff0c\u7fa4\u4f53\u8d8a\u5927\uff0c\u9891\u7387\u8f68\u8ff9\u8d8a\u63a5\u8fd1\u5e38\u6570\uff08\u6f02\u53d8\u88ab\u201c\u538b\u6241\u201d\u4e86\uff09\u3002\u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\u4e0d\u80fd\u76f4\u63a5\u7528 (t) \u6765\u53d6\u6781\u9650\uff1a\u6781\u9650\u4f1a\u53d8\u5f97\u65e0\u804a\u3002</p>"},{"location":"03_Models/Wright_Fisher_model/#22-t-n","title":"2.2 \u8ba9\u6781\u9650\u201c\u6709\u4e1c\u897f\u53d1\u751f\u201d\uff1a\u9700\u8981\u8ba9 (t) \u4e0e (N) \u540c\u9636","text":"<p>\u8981\u8ba9\u7d2f\u8ba1\u6ce2\u52a8\u4fdd\u6301 (O(1))\uff08\u65e2\u4e0d\u7206\u70b8\u4e5f\u4e0d\u6d88\u5931\uff09\uff0c\u6211\u4eec\u5e0c\u671b</p> <p>[ \\mathrm{Var}(p_t-p_0)\\sim O(1). ]</p> <p>\u7531\u4e0a\u9762\u7684\u91cf\u7ea7 (O(t/N))\uff0c\u8fd9\u8981\u6c42</p> <p>[ \\frac{t}{N}=O(1)\\quad \\Longrightarrow\\quad t=O(N). ]</p> <p>WF \u91cc\u81ea\u7136\u51fa\u73b0\u7684\u5e38\u6570\u662f (2N)\uff08\u56e0\u4e3a\u4e8c\u500d\u4f53\u6709 (2N) \u62f7\u8d1d\uff0c\u5e76\u4e14\u65b9\u5dee\u91cc\u5c31\u662f (2N)\uff09\uff0c\u6240\u4ee5\u6211\u4eec\u4ee4</p> <p>[ t = 2N\\tau \\quad\\Longleftrightarrow\\quad \\tau=\\frac{t}{2N}. ]</p> <p>\u628a\u8fd9\u4e2a\u4ee3\u56de\u7d2f\u8ba1\u65b9\u5dee\u7684\u91cf\u7ea7\uff1a</p> <p>[ \\mathrm{Var}(p_{2N\\tau}-p_0)\\approx O!\\left(\\frac{2N\\tau}{N}\\right)=O(\\tau), ]</p> <p>\u8fd9\u5c31\u5b8c\u7f8e\u4e86\uff1a\u5728 (\\tau) \u5c3a\u5ea6\u4e0a\uff0c\u6ce2\u52a8\u4e0d\u4f1a\u56e0\u4e3a (N\\to\\infty) \u800c\u6d88\u5931\uff0c\u4e8e\u662f\u624d\u53ef\u80fd\u6536\u655b\u5230\u4e00\u4e2a\u975e\u9000\u5316\u7684 diffusion\u3002</p>"},{"location":"03_Models/Wright_Fisher_model/#23-tau-2n","title":"2.3 \u518d\u7528\u201c\u6bcf\u5355\u4f4d (\\tau) \u7684\u65b9\u5dee\u589e\u91cf\u201d\u89e3\u91ca\u4e3a\u4ec0\u4e48\u662f (2N)","text":"<p>1 \u4ee3\u5bf9\u5e94\u7684 (\\tau) \u589e\u91cf\u662f [ \\Delta\\tau = \\frac{1}{2N}. ]</p> <p>\u6211\u4eec\u5df2\u7ecf\u6709\u5355\u4ee3 [ \\mathrm{Var}(\\Delta p_t\\mid p_t)=\\frac{p_t(1-p_t)}{2N}. ]</p> <p>\u4e8e\u662f\u201c\u6bcf\u5355\u4f4d (\\tau)\u201d\u7684\u65b9\u5dee\u589e\u957f\u7387\uff08\u628a\u65b9\u5dee\u9664\u4ee5\u65f6\u95f4\u6b65\u957f\uff09\u662f</p>"},{"location":"03_Models/Wright_Fisher_model/#_1","title":"[","text":"<p>\\frac{\\mathrm{Var}(\\Delta p_t\\mid p_t)}{\\Delta\\tau}</p> <p>\\frac{\\frac{p_t(1-p_t)}{2N}}{\\frac{1}{2N}} = p_t(1-p_t), ]</p> <p>\u8fd9\u662f\u4e00\u4e2a (O(1)) \u7684\u91cf\uff0c\u4e0d\u4f9d\u8d56 (N)\u3002\u8fd9\u6b63\u662f\u4f60\u5e0c\u671b\u5728\u6781\u9650\u91cc\u7559\u4e0b\u6765\u7684\u6269\u6563\u7cfb\u6570\u3002</p> <p>\u5982\u679c\u4f60\u4e0d\u7528 (\\tau=t/(2N))\uff0c\u800c\u7528 (\\tau=t/N) \u6216 (\\tau=t)\uff0c\u8fd9\u4e2a\u201c\u65b9\u5dee\u589e\u957f\u7387\u201d\u8981\u4e48\u591a\u4e00\u4e2a\u5e38\u6570\u56e0\u5b50\uff08\u8fd8\u597d\u4f46\u4e0d\u6807\u51c6\uff09\uff0c\u8981\u4e48\u8d8b\u4e8e 0\uff08\u9000\u5316\uff09\uff0c\u6240\u4ee5\u4f20\u7edf\u4e0a\u7528 (2N) \u6765\u628a\u7cfb\u6570\u5199\u5f97\u6700\u5e72\u51c0\u3002</p>"},{"location":"03_Models/Wright_Fisher_model/#_2","title":"\u4f60\u53ef\u4ee5\u8bb0\u6210\u4e24\u53e5\u201c\u786c\u903b\u8f91\u94fe\u201d","text":"<ul> <li> <p>\u5355\u4ee3\u6f02\u53d8\u7684\u4e8c\u9636\u77e9\uff1a     [     \\mathrm{Var}(\\Delta p\\mid p)=\\frac{p(1-p)}{2N}=O!\\left(\\frac{1}{N}\\right)     \\Rightarrow \\Delta p = O!\\left(\\frac{1}{\\sqrt{N}}\\right).     ]</p> </li> <li> <p>(t) \u4ee3\u7d2f\u8ba1\u6ce2\u52a8\uff1a     [     \\mathrm{Var}(p_t-p_0)\\approx O!\\left(\\frac{t}{N}\\right)     \\Rightarrow t \\text{ \u5fc5\u987b\u53d6 } O(N) \\text{ \u624d\u6709\u975e\u5e73\u51e1\u6781\u9650}     \\Rightarrow \\tau=\\frac{t}{2N}.     ]</p> </li> </ul> <p>\u5982\u679c\u4f60\u63a5\u4e0b\u6765\u8981\u628a\u5b83\u63a8\u8fdb\u5230 diffusion\uff0c\u6211\u53ef\u4ee5\u76f4\u63a5\u628a\u8fd9\u5957\u91cf\u7ea7\u63a8\u5bfc\u53d8\u6210\u6807\u51c6\u5f62\u5f0f\uff1a \u7528 (\\tau=t/(2N)) \u5b9a\u4e49\u63d2\u503c\u8fc7\u7a0b (p^{(N)}(\\tau))\uff0c\u7136\u540e\u5199\u51fa\u5b83\u7684 infinitesimal mean/variance\uff08\u751f\u6210\u5143\uff09\uff0c\u6700\u540e\u5f97\u5230 Fokker\u2013Planck \u6216 SDE\u3002\u4f60\u60f3\u5148\u770b \u751f\u6210\u5143\uff08generator\uff09 \u7684\u63a8\u6cd5\uff0c\u8fd8\u662f\u76f4\u63a5\u4ece SDE \u5199\u8d77\uff1f</p>"}]}